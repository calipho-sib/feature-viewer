var FeatureViewer;!function(){var t={228:function(t){"object"==typeof t.exports&&(t.exports=function(t,e,n){var a=this;this.events={FEATURE_SELECTED_EVENT:"feature-viewer-position-selected",FEATURE_DESELECTED_EVENT:"feature-viewer-position-deselected",ZOOM_EVENT:"feature-viewer-zoom-altered"};var r,l=document.getElementById(e.substring(1)),i=Number.isInteger(t)?t:null,s=i|t.length,o=[],c={showSequence:!1,brushActive:!1,verticalLine:!1,dottedSequence:!0},p={start:1,end:s};n&&n.offset&&(p=n.offset).start<1&&(p.start=1,console.warn("WARNING ! offset.start should be > 0. Thus, it has been reset to 1."));var d,u,h,f,y=0,x=[],g=20,m=0,v=0,b=50,A={length:p.end-p.start,start:p.start,end:p.end},w={},E=!0;function N(t,e){w!=={}&&d3.select(w.id).style("fill",w.originalColor),"path"!==e.type&&"line"!==e.type&&(w={id:t,originalColor:d3.select(t).style("fill")||e.color},d3.select(t).style("fill","orangered"))}d3.select(e).style("position","relative").style("padding","0px").style("z-index","2");var k=10,z=20,q=20,T=110,_=$(e).width()-T-z-17,L=600-k-q,R=d3.scale.linear().domain([p.start,p.end]).range([5,_-5]),S=d3.scale.linear().domain([0,_]).range([p.start,p.end]);function F(t,e){for(var n=t-110,a="",r=0;r<e.length;r++)if(R(e[r].x)<n&&R(e[r+1].x)>n){a=n-R(e[r].x)<R(e[r+1].x)-n?e[r]:e[r+1];break}return a}d3.helper={},d3.helper.tooltip=function(t){var l,i,s=d3.select(e).node(),o=n.tooltipColor?n.tooltipColor:"orangered";function p(n){n.on("mouseover.tooltip",(function(n,a){d3.select("body").selectAll("div.tooltip").remove();var r=d3.mouse(s),i=r[0]>_;if(i?l=d3.select(e).append("div").attr("class","tooltip3"):(l=d3.select(e).append("div").attr("class","tooltip2")).style({left:r[0]-15+"px"}),l.style({bottom:s.offsetHeight-r[1]+16+"px","background-color":"#eee",width:"auto","max-width":"170px",height:"auto","max-height":"68px",padding:"5px",font:"10px sans-serif","text-align":"center",position:"absolute","z-index":45,"box-shadow":"0 1px 2px 0 #656565"}),"path"===t.type){var c='<p style="margin:2px;font-weight:700;color:'+o+'">'+n[0].x+"&#x256d;&#x256e;"+n[1].x+"</p>";if(n.description)var p='<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>";else p=""}else if("line"===t.type){var d=F(r[0],n);d.description?(c='<p style="margin:2px;font-weight:700;color:'+o+'">'+d.x+" : <span> "+d.y+"</span></p>",p='<p style="margin:2px;color:'+o+';font-size:9px">'+d.description+"</p>"):(c='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+d.x+"</span></p>",p='<p style="margin:2px;color:'+o+'">count : <span id="tLineC">'+d.y+"</span></p>")}else"bar"===t.type?n.description?c='<p style="margin:2px;font-weight:700;color:'+o+';font-size:9px">'+n.description+"</p>":(c='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+n.x+"</span></p>",p='<p style="margin:2px;color:'+o+'">frequency : <span id="tLineC">'+(n.absoluteY?n.absoluteY:n.y)+"</span></p>"):"unique"===t.type||n.x===n.y?(c='<p style="margin:2px;font-weight:700;color:'+o+'">'+n.x+"</p>",p=n.description?'<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>":""):(c='<p style="margin:2px;font-weight:700;color:'+o+'">'+n.x+" - "+n.y+"</p>",p=n.description?'<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>":"");p?l.html(c+p):l.html(c),i&&l.style({left:r[0]+10-l.node().getBoundingClientRect().width+"px"})})).on("mousemove.tooltip",(function(e,n){if("line"===t.type){var a=F((c=d3.mouse(s))[0],e);if(a.description)var r='<p style="margin:2px;color:'+o+'">'+a.x+" : <span> "+a.y+"</span></p>",i='<p style="margin:2px;color:'+o+';font-size:9px">'+a.description+"</p>";else r='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+a.x+"</span></p>",i='<p style="margin:2px;color:'+o+'">count : <span id="tLineC">'+a.y+"</span></p>";l.html(r+i)}var c;void 0!==l&&((c=d3.mouse(s))[0]>_?(l.attr("class","tooltip3"),l.style({left:c[0]+10-l.node().getBoundingClientRect().width+"px",bottom:s.offsetHeight-c[1]+16+"px"})):(l.attr("class","tooltip2"),l.style({left:c[0]-15+"px",bottom:s.offsetHeight-c[1]+16+"px"})))})).on("mouseout.tooltip",(function(t,e){l.remove()})).on("click",(function(n,l){var o,p,d,h,f;if("text"===this.nodeName){var y="#"+this.previousSibling.id;"#"!==y.nodeName&&N(y,t)}else N(this,t);var x=c.brushActive?d3.select(".background").attr("width"):u.node().getBBox().width;if(d3.select("body").selectAll("div.selectedRect").remove(),i=d3.select(e).append("div").attr("class","selectedRect"),"path"===t.type?(o=n[0].x,p=n[1].x):"line"===t.type?(o=(f=F(d3.mouse(s)[0],n)).x-.5,p=f.x+.5):"unique"===t.type||n.x===n.y?(o=n.x-.4,p=n.y+.4):(o=n.x,p=n.y),R(o)<0&&R(p)>x?(d=T,h=parseInt(x)+5):R(o)<0?(d=T,h=R(p)):R(p)>x?(d=R(o)+T,h=parseInt(x)-R(o),h+=5):(d=R(o)+T,h=R(p)-R(o)),i.style({left:d+"px",top:$(e+" .svgHeader").length?"60px":"10px","background-color":"rgba(0, 0, 0, 0.2)",width:h+"px",height:g+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"}),CustomEvent){var m=new CustomEvent(a.events.FEATURE_SELECTED_EVENT,{detail:{start:"path"===t.type?n[0].x:"line"===t.type?f.x:n.x,end:"path"===t.type?n[1].x:"line"===t.type?f.y:n.y,id:"path"===t.type?n[0].id:"line"===t.type?f.id:n.id,description:"path"===t.type?n[0].description:"line"===t.type?f.description:n.description}});r.dispatchEvent(m)}else console.warn("CustomEvent is not defined....");a.trigger&&a.trigger(a.events.FEATURE_SELECTED_EVENT,{start:"path"===t.type?n[0].x:"line"===t.type?f.x:n.x,end:"path"===t.type?n[1].x:"line"===t.type?f.y:n.y,id:"path"===t.type?n[0].id:"line"===t.type?f.id:n.id,description:"path"===t.type?n[0].description:"line"===t.type?f.description:n.description})}))}return p.attr=function(t){return arguments.length?(attrs=t,this):attrs},p.style=function(t){return arguments.length?(styles=t,this):styles},p};var C=function(t){return R(t.x)},D=function(t){return _/t>5},M=function(t){return R(t.y)-R(t.x)};function V(t){return t.x===t.y?R(t.x-.4):R(t.x)}function O(t){return t.x===t.y?R(t.x+.4)-R(t.x-.4)<2?2:R(t.x+.4)-R(t.x-.4):R(t.y)-R(t.x)}function I(t){var e=[];return t.forEach((function(t){if(e===[])e.push(t.y),t.level=0;else{for(var n=!1,a=0;a<e.length;a++)if(t.x>e[a]){n=!0,t.level=a,e[a]=t.y;break}!1===n&&(e.push(t.y),t.level=e.length-1)}})),e.length}this.onFeatureSelected=function(t){r.addEventListener(a.events.FEATURE_SELECTED_EVENT,t)},this.onFeatureDeselected=function(t){r.addEventListener(a.events.FEATURE_DESELECTED_EVENT,t)},this.onZoom=function(t){r.addEventListener(a.events.ZOOM_EVENT,t)};var G=d3.svg.line().interpolate("step-before").x((function(t){return R(t.x)})).y((function(t){return 10*-t.y+y})),U=d3.svg.line().x((function(t){return R(t.x)})).y((function(t){return 10*B(-t.y)+y})),B=d3.scale.linear().domain([0,-30]).range([0,-20]),H=d3.svg.line().interpolate("linear").x((function(t){return R(t.x)})).y((function(t){return t.y+6})),Z=d3.svg.axis().scale(R).tickFormat(d3.format("d")).orient("bottom");function X(t,e,n){if("number"!=typeof t||t<-1||t>1||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||"string"!=typeof n&&void 0!==n)return null;this.sbcRip||(this.sbcRip=function(t){var e=t.length,n=new Object;if(e>9){if((t=t.split(",")).length<3||t.length>4)return null;n[0]=a(t[0].slice(4)),n[1]=a(t[1]),n[2]=a(t[2]),n[3]=t[3]?parseFloat(t[3]):-1}else{if(8==e||6==e||e<4)return null;e<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(e>4?t[4]+""+t[4]:"")),t=a(t.slice(1),16),n[0]=t>>16&255,n[1]=t>>8&255,n[2]=255&t,n[3]=9==e||5==e?r((t>>24&255)/255*1e4)/1e4:-1}return n});var a=parseInt,r=Math.round,l=e.length>9,i=(l="string"==typeof n?n.length>9||"c"==n&&!l:l,t<0),s=(t=i?-1*t:t,n=n&&"c"!=n?n:i?"#000000":"#FFFFFF",sbcRip(e)),o=sbcRip(n);return s&&o?l?"rgb("+r((o[0]-s[0])*t+s[0])+","+r((o[1]-s[1])*t+s[1])+","+r((o[2]-s[2])*t+s[2])+(s[3]<0&&o[3]<0?")":","+(s[3]>-1&&o[3]>-1?r(1e4*((o[3]-s[3])*t+s[3]))/1e4:o[3]<0?s[3]:o[3])+")"):"#"+(4294967296+16777216*(s[3]>-1&&o[3]>-1?r(255*((o[3]-s[3])*t+s[3])):o[3]>-1?r(255*o[3]):s[3]>-1?r(255*s[3]):255)+65536*r((o[0]-s[0])*t+s[0])+256*r((o[1]-s[1])*t+s[1])+r((o[2]-s[2])*t+s[2])).toString(16).slice(s[3]>-1||o[3]>-1?1:3):null}function j(t){d.attr("height",t+60+"px"),d.select("clippath rect").attr("height",t+60+"px")}var Y=d3.scale.ordinal().domain([0,x.length]).rangeRoundBands([0,500],.1);function P(){(f=h.selectAll(".yaxis").data(x).enter().append("g")).append("polygon").attr("class",(function(t){return t.filter?t.filter.split(" ").join("_")+"Arrow":"Arrow"})).style("stroke","").style("fill","#DFD5D3").attr("points",(function(t){return T-105+","+(t.y-3)+", "+(T-105)+","+(t.y+12)+", "+(T-15)+","+(t.y+12)+", "+(T-7)+","+(t.y+4.5)+", "+(T-15)+","+(t.y-3)})),f.append("text").attr("class","yaxis").attr("text-anchor","start").attr("x",(function(){return T-102})).attr("y",(function(t){return t.y+8})).text((function(t){return t.title}))}function W(t){t.on("mousedown",(function(){brush_elm=d.select(".brush").node(),new_click_event=new Event("mousedown"),new_click_event.pageX=d3.event.pageX,new_click_event.clientX=d3.event.clientX,new_click_event.pageY=d3.event.pageY,new_click_event.clientY=d3.event.clientY,brush_elm&&brush_elm.dispatchEvent(new_click_event)}))}d3.svg.axis().scale(Y).tickValues(x).tickFormat((function(t){return t})).orient("left");var J=function(t){t.data.sort((function(t,e){return t.x-e.x}));var e=I(t.data);t.data=t.data.map((function(t){return[{x:t.x,y:0,id:t.id,description:t.description,color:t.color},{x:t.y,y:t.level+1,id:t.id},{x:t.y,y:0,id:t.id}]})),y=10*e+5,t.height=10*e+5},K=function(t){t.height||(t.height=10);var e=parseInt(t.height),n=0;for(var a in t.data){t.data[a].sort((function(t,e){return t.x-e.x})),0!==t.data[a][0].y&&t.data[a].unshift({x:t.data[a][0].x-1,y:0}),0!==t.data[a][t.data[a].length-1].y&&t.data[a].push({x:t.data[a][t.data[a].length-1].x+1,y:0});var r=Math.max.apply(Math,t.data[a].map((function(t){return Math.abs(t.y)})));n=r>n?r:n,t.data[a]=[t.data[a].map((function(t){return{x:t.x,y:t.y,id:t.id,description:t.description}}))]}B.range([0,-e]).domain([0,-n]),y=10*e+5,t.level=n,t.shift=10*e+5},Q=function(t){t.height||(t.height=10);var e=parseInt(t.height),n=0;for(var a in t.data){t.data[a].sort((function(t,e){return t.x-e.x})),0!==t.data[a][0].y&&t.data[a].unshift({x:t.data[a][0].x-1,y:0}),0!==t.data[a][t.data[a].length-1].y&&t.data[a].push({x:t.data[a][t.data[a].length-1].x+1,y:0});var r=Math.max.apply(Math,t.data[a].map((function(t){return Math.abs(t.y)})));n=r>n?r:n}B.range([0,-e]).domain([0,-n]),y=10*e+5,t.maxValue=r,t.level=n,t.shift=10*e+5},tt=function(t){t.data.sort((function(t,e){return t.x-e.x})),t.highlight&&Array.isArray(t.highlight)&&t.highlight.forEach((function(e){for(var n in t.data)e.x==t.data[n].x&&e.y==t.data[n].y&&(t.data[n].highlight=!0,t.data[n].color=e.color,t.data[n].description=e.highlightText)})),m=I(t.data),y=10*m+5},et={typeIdentifier:function(t){if("rect"===t.type)tt(t),x.push({title:t.name,y:g,filter:t.filter}),et.rectangle(t,g);else if("text"===t.type)et.sequence(t.data,g),x.push({title:t.name,y:g,filter:t.filter}),R.range([5,_-5]);else if("unique"===t.type)et.unique(t,g),x.push({title:t.name,y:g,filter:t.filter});else if("multipleRect"===t.type)tt(t),et.multipleRect(t,g,m),x.push({title:t.name,y:g,filter:t.filter}),g+=10*(m-1);else if("path"===t.type)J(t),et.path(t,g),g+=y,x.push({title:t.name,y:g-10,filter:t.filter});else if("line"===t.type){Array.isArray(t.data[0])||(t.data=[t.data]),Array.isArray(t.color)||(t.color=[t.color]);var e=!1;t.data.forEach((function(t){t.filter((function(t){return t.y<0})).length&&(e=!0)})),K(t),et.line(t,g),g+=y,x.push({title:t.name,y:g-10,filter:t.filter}),g+=e?y-5:0}else"bar"===t.type&&(Array.isArray(t.data[0])||(t.data=[t.data]),Array.isArray(t.color)||(t.color=[t.color]),e=!1,t.data.forEach((function(t){t.filter((function(t){return t.y<0})).length&&(e=!0)})),Q(t),et.bar(t,g),g+=y,x.push({title:t.name,y:g-10,filter:t.filter}),g+=e?y-5:0)},sequence:function(t,e,n){n||(n=0),u.append("g").attr("class","seqGroup").selectAll(".AA").data(t).enter().append("text").attr("clip-path","url(#clip)").attr("class","AA").attr("text-anchor","middle").attr("x",(function(t,e){return R.range([5,_-5])(e+n)})).attr("y",e).attr("font-size","10px").attr("font-family","monospace").text((function(t,e){return t}))},sequenceLine:function(){c.dottedSequence&&u.selectAll(".sequenceLine").data([[{x:1,y:12},{x:s,y:12}]]).enter().append("path").attr("clip-path","url(#clip)").attr("d",H).attr("class","sequenceLine").style("z-index","0").style("stroke","black").style("stroke-dasharray","1,3").style("stroke-width","1px").style("stroke-opacity",0).transition().duration(500).style("stroke-opacity",1)},rectangle:function(t,e){t.height||(t.height=12),void 0!==t.showDescriptionRect&&null!==t.showDescriptionRect||(t.showDescriptionRect=!0);for(var n=t.height,a=n+n/3,r=n/2-6,l=u.append("g").attr("class","rectangle").attr("clip-path","url(#clip)").attr("transform","translate(0,"+e+")"),i=[],o=0;o<m;o++)i.push([{x:1,y:o*a+r},{x:s,y:o*a+r}]);l.selectAll(".line"+t.className).data(i).enter().append("path").attr("d",H).attr("class",(function(){return"line"+t.className})).style("z-index","0").style("stroke",t.color).style("stroke-width","1px");var c=l.selectAll("."+t.className+"Group").data(t.data).enter().append("g").attr("class",t.className+"Group").attr("transform",(function(t){return"translate("+V(t)+",0)"}));c.append("rect").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("y",(function(t){return t.level*a})).attr("width",O).attr("height",n).style("fill",(function(e){return e.color||t.color})).style("z-index","13").call(d3.helper.tooltip(t)),t.showDescriptionRect&&c.append("text").attr("class","element "+t.className+"Text").attr("y",(function(t){return t.level*a+n/2})).attr("dy","0.35em").style("font-size","10px").text((function(t){return t.description})).style("fill","black").style("z-index","15").style("visibility",(function(t){return t.description&&R(t.y)-R(t.x)>8*t.description.length&&n>11?"visible":"hidden"})).call(d3.helper.tooltip(t)),W(c);var p=n>12?n-6:0;g+=m<2?p:(m-1)*a+p},unique:function(t,e){var n=u.append("g").attr("class","uniquePosition").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:s,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",H).attr("class","line"+t.className).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),n.selectAll("."+t.className).data(t.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("x",(function(t){return R(t.x-.4)})).attr("width",(function(t){return R(t.x+.4)-R(t.x-.4)<2?2:R(t.x+.4)-R(t.x-.4)})).attr("height",12).style("fill",(function(e){return e.color||t.color})).style("z-index","3").call(d3.helper.tooltip(t)),W(n)},path:function(t,e){var n=u.append("g").attr("class","pathing").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:s,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",G).attr("class","line"+t.className).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),n.selectAll("."+t.className).data(t.data).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t[0].id})).attr("d",G).style("fill","none").style("stroke",(function(e){return e[0].color||t.color})).style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(t)),W(n)},line:function(t,e){t.interpolation||(t.interpolation="monotone"),void 0===t.fill&&(t.fill=!0);var n=u.append("g").attr("class","lining").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:s,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",G).attr("class","line"+t.className).style("z-index","0").style("stroke","black").style("stroke-width","1px"),t.data.forEach((function(e,a,r){n.selectAll("."+t.className+a).data(e).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+t.className+" "+t.className+a).attr("d",U.interpolate(t.interpolation)).style("fill",t.fill?X(.6,t.color[a])||X(.6,"#000"):"none").style("stroke",t.color[a]||"#000").style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(t))})),W(n)},bar:function(t,e){void 0===t.fill&&(t.fill=!0);var n=u.append("g").attr("class","bar").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:s,y:0}]);var r=d3.scale.linear().domain([0,t.maxValue]).range([0,t.shift]);n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",U).attr("class","line"+t.className).style("z-index","0").style("stroke","black").style("stroke-width","1px"),t.data.forEach((function(e,a,l){n.selectAll().data(e).enter().append("rect").attr("class","element "+t.className).attr("x",(function(t){return R(t.x-.4)})).attr("width",(function(t){return R(t.x+.4)-R(t.x-.4)<2?2:R(t.x+.4)-R(t.x-.4)})).attr("y",(function(e){return t.shift-r(e.y)})).attr("height",(function(t){return r(t.y)})).style("fill",(function(e){return e.color||t.color})).style("z-index","3").call(d3.helper.tooltip(t))})),W(n)},multipleRect:function(t,e,n){for(var a=u.append("g").attr("class","multipleRects").attr("transform","translate(0,"+e+")"),r=0;r<n;r++)a.append("path").attr("d",H([{x:1,y:10*r-2},{x:s,y:10*r-2}])).attr("class",(function(){return"line"+t.className})).style("z-index","0").style("stroke",t.color).style("stroke-width","1px");a.selectAll("."+t.className).data(t.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("x",C).attr("y",(function(t){return 10*t.level})).attr("width",M).attr("height",8).style("fill",(function(e){return e.color||t.color})).style("z-index","13").call(d3.helper.tooltip(t)),W(a)}};this.showFilteredFeature=function(t,e,n){h.selectAll("."+t+"Arrow");var a=T-105,r=T-7,l=d.append("linearGradient").attr("y1","0").attr("y2","0").attr("x1",a).attr("x2",r).attr("id","gradient").attr("spreadMethod","pad").attr("gradientUnits","userSpaceOnUse");l.append("stop").attr("offset","0.3").attr("stop-color","#DFD5D3").attr("stop-opacity",1),l.append("stop").attr("offset","1").attr("stop-opacity",1).attr("stop-color","#DFD5D3").attr("stop-color",e);var i="url(#gradient)",s="url(#dropshadow)";n&&(i="url("+n+"#gradient)",s="url("+n+"#dropshadow)"),h.selectAll("."+t+"Arrow").style("fill",i).style("stroke","").attr("filter",s).attr("points",(function(t){return T-105+","+(t.y-3)+", "+(T-105)+","+(t.y+12)+", "+(T-10)+","+(t.y+12)+", "+(T-2)+","+(t.y+4.5)+", "+(T-10)+","+(t.y-3)}))},this.hideFilteredFeature=function(t){h.selectAll("."+t+"Arrow").style("fill","rgba(95,46,38,0.2)").attr("filter","").attr("points",(function(t){return T-105+","+(t.y-3)+", "+(T-105)+","+(t.y+12)+", "+(T-15)+","+(t.y+12)+", "+(T-7)+","+(t.y+4.5)+", "+(T-15)+","+(t.y-3)}))};var nt=function(t){u.selectAll(".line"+t.className).attr("d",H.x((function(t){return R(t.x)}))),E?(transit1=u.selectAll("."+t.className+"Group").transition().duration(500),transit2=u.selectAll("."+t.className).transition().duration(500)):(transit1=u.selectAll("."+t.className+"Group"),transit2=u.selectAll("."+t.className)),transit1.attr("transform",(function(t){return"translate("+V(t)+",0)"})),transit2.attr("width",O),u.selectAll("."+t.className+"Text").style("visibility",(function(e){return e.description&&R(e.y)-R(e.x)>8*e.description.length&&t.height>11?"visible":"hidden"}))},at=function(t){u.selectAll("."+t.className).attr("x",(function(t){return R(t.x)})).attr("width",(function(t){return R(t.y)-R(t.x)}))},rt=function(t){u.selectAll(".line"+t.className).attr("d",H.x((function(t){return R(t.x)}))),(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("x",(function(t){return R(t.x-.4)})).attr("width",(function(t){return R(t.x+.4)-R(t.x-.4)<2?2:R(t.x+.4)-R(t.x-.4)}))},lt=function(t){u.selectAll(".line"+t.className).attr("d",G.x((function(t){return R(t.x)})).y((function(e){return 10*-e.y+t.height}))),(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("d",G.y((function(e){return 10*-e.y+t.height})))},it=function(t){B.range([0,-t.height]).domain([0,-t.level]),u.selectAll(".line"+t.className).attr("d",U.y((function(e){return 10*B(-e.y)+t.shift}))),(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("d",U.y((function(e){return 10*B(-e.y)+t.shift})).interpolate(t.interpolation))},st=function(t){(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("x",(function(t){return R(t.x-.4)})).attr("width",(function(t){return R(t.x+.4)-R(t.x-.4)<2?2:R(t.x+.4)-R(t.x-.4)}))},ot=function(t,e){(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("x",(function(t,n){return R(n+e)}))},ct=d3.svg.brush().x(R).on("brushend",pt);function pt(){if(d3.select(e).selectAll("div.selectedRect").remove(),0!==Object.keys(w).length&&w.constructor===Object){if(d3.select(w.id).style("fill",w.originalColor),w={},CustomEvent){var n=new CustomEvent(a.events.FEATURE_DESELECTED_EVENT,{detail:{info:"feature-deselected"}});r.dispatchEvent(n)}else console.warn("CustomEvent is not defined....");a.trigger&&a.trigger(a.events.FEATURE_DESELECTED_EVENT,{info:"feature-deselected"})}var l=ct.extent(),d=Math.abs(l[0]-l[1]);if(l[0]<l[1])var h=parseInt(l[0]-1),f=parseInt(l[1]+1);else h=parseInt(l[1]+1),f=parseInt(l[0]-1);var y=D(d);if(!ct.empty()&&d>b){A.length=d;var x=(s/d).toFixed(1);$(e+" .zoomUnit").text(x.toString()),c.showSequence&&!i&&y&&u.selectAll(".AA").empty()&&(A={length:d,start:h,end:f},v=h,u.selectAll(".sequenceLine").remove(),et.sequence(t.substring(h-1,f),20,v-1)),R.domain(l),S.range(l);var g=v||p.start;ht(o,g),ft(),CustomEvent&&r.dispatchEvent(new CustomEvent(a.events.ZOOM_EVENT,{detail:{start:h,end:f,zoom:x}})),a.trigger&&a.trigger(a.events.ZOOM_EVENT,{start:h,end:f,zoom:x}),d3.select(e).selectAll(".brush").call(ct.clear())}else d3.select(e).selectAll(".brush").call(ct.clear())}this.zoom=function(t,e){A.start<t&&A.end>e||u.selectAll(".seqGroup").remove(),ct.extent([t,e]),pt()},this.resetZoom=function(t,e){ut()};var dt=function(){!function(){_=$(e).width()-T-z-17,d3.select(e+" svg").attr("width",_+T+z),d3.select(e+" #clip>rect").attr("width",_),c.brushActive&&d3.select(e+" .background").attr("width",_),d3.select(e).selectAll(".brush").call(ct.clear());var n=D(A.length);c.showSequence&&!i&&(!1!==n||u.selectAll(".AA").empty()?!0===n&&u.selectAll(".AA").empty()&&(u.selectAll(".sequenceLine").remove(),et.sequence(t.substring(A.start-1,A.end),20,A.start-1)):(u.selectAll(".seqGroup").remove(),et.sequenceLine())),R.range([5,_-5]),S.domain([0,_]),ht(o,A.start),ft()}()};function ut(){$(".zoomUnit").text("1"),R.domain([p.start,p.end]),S.range([p.start,p.end]);var n=D(p.end-p.start);c.showSequence&&!i&&(!1!==n||u.selectAll(".AA").empty()?A.length===s||!0!==n||u.selectAll(".AA").empty()||(u.selectAll(".seqGroup").remove(),et.sequence(t.substring(p.start-1,p.end),20,p.start)):(u.selectAll(".seqGroup").remove(),et.sequenceLine())),A={length:p.end-p.start,start:p.start,end:p.end},v=0,ht(o,p.start),ft(),CustomEvent&&r.dispatchEvent(new CustomEvent(a.events.ZOOM_EVENT,{detail:{start:1,end:t.length,zoom:1}})),a.trigger&&a.trigger(a.events.ZOOM_EVENT,{start:1,end:t.length,zoom:1}),d3.select(e).selectAll(".brush").call(ct.clear())}function ht(t,e){t.forEach((function(t){"rect"===t.type?nt(t):"multipleRect"===t.type?at(t):"unique"===t.type?rt(t):"path"===t.type?lt(t):"line"===t.type?it(t):"text"===t.type?ot(t,e):"bar"===t.type&&st(t,e)}))}function ft(){u.transition().duration(500).select(".x.axis").call(Z)}$(window).on("resize",dt),this.addRectSelection=function(t){var n,a,r,l,i=d3.select(t),s=i.data(),o=c.brushActive?d3.select(".background").attr("width"):u.node().getBBox().width;d3.select("body").selectAll("div.selectedRect").remove(),N(t,{type:i[0][0].tagName,color:i.style("fill")});var p=d3.select(e).append("div").attr("class","selectedRect");3===s[0].length?(n=s[0][0].x,a=s[0][1].x):s[0].x===s[0].y?(n=s[0].x-.5,a=s[0].y+.5):(n=s[0].x,a=s[0].y),R(n)<0?(r=T,l=R(a)):R(a)>o?(r=R(n)+T,l=o-R(n)):(r=R(n)+T,l=R(a)-R(n)),p.style({left:r+"px",top:"60px","background-color":"rgba(0, 0, 0, 0.2)",width:l+"px",height:g+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"})},function(e,n){if(void 0===n&&(n={showAxis:!1,showSequence:!1,brushActive:!1,verticalLine:!1,toolbar:!1,bubbleHelp:!1,showvariant:!1,unit:"units",zoomMax:50}),$.fn.popover||(n.bubbleHelp=!1,console.warn("The bubble help requires tooltip and popover bootstrap js libraries. The feature viewer will continue to work, but without the info bubble")),n.zoomMax&&(b=n.zoomMax),n.unit||(n.unit="units"),n.animation&&(E=n.animation),!0===n.toolbar){var a=$(e+" .svgHeader").length?d3.select(e+" .svgHeader"):d3.select(e).append("div").attr("class","svgHeader");if(!$(e+" .header-position").length){var s=a.append("div").attr("class","header-position").style("display","inline-block").style("margin","15px 10px 0px").style("padding","0px").style("line-height","32px");s.append("div").attr("class","position-label").style("padding","0px 5px").style("display","inline-block").style("padding","0px").style("font-weight","700").text("Position  :  "),s.append("div").style("display","inline-block").style("padding","0px").style("padding-left","5px").append("div").style("min-width","50px").attr("id","zoomPosition").text("0")}$(e+" .header-zoom").length||((f=a.append("div").attr("class","header-zoom").style("display","inline-block").style("margin","15px 0px 0px").style("padding","0px").style("line-height","32px")).append("div").attr("class","zoom-label").style("padding","0px 5px").style("display","inline-block").style("padding","0px").style("font-weight","700").text("Zoom : "),f.append("div").style("display","inline-block").style("padding","0px").append("div").style("min-width","50px").style("padding-left","5px").append("span").text("x ").append("span").attr("class","zoomUnit").text("1"));var f=$(e+" .header-zoom").length?d3.select(e+" .header-zoom"):a;if(!0===n.bubbleHelp&&!$(e+" .header-help").length){var y="<div><strong>To zoom in :</strong> Left click to select area of interest</div><div><strong>To zoom out :</strong> Right click to reset the scale</div><div><strong>Zoom max  :</strong> Limited to <strong>"+b.toString()+" "+n.unit+"</strong></div>";f.append("div").style("display","inline-block").style("margin","0px").style("margin-right","5px").style("padding","0px").append("a").attr("type","button").attr("class","header-help").attr("data-toggle","popover").attr("data-placement","auto left").attr("title","Help").attr("data-content",y).style("font-size","14px").append("span").attr("class","label label-as-badge label-info").style("font-weight","500").style("border-radius","3px").style("box-shadow","inset 0px 0px 4px rgba(0,0,0,0.10)").style("color","#fff").html("<span class='state'>Show</span> help"),$((function(){$('[data-toggle="popover"]').popover({html:!0}),$(e+" .header-help").on("hide.bs.popover",(function(){$(this).find(".state").text("Show")})),$(e+" .header-help").on("show.bs.popover",(function(){$(this).find(".state").text("Hide")}))}))}}d=d3.select(e).append("svg").attr("width",_+T+z).attr("height",L+k+q).style("z-index","2").on("contextmenu",(function(t,e){d3.event.preventDefault(),ut()})),r=l.getElementsByTagName("svg")[0];var m=(u=d.append("g").attr("transform","translate("+T+","+k+")")).append("defs");m.append("clipPath").attr("id","clip").append("rect").attr("width",_).attr("height",L);var v=m.append("filter").attr("id","dropshadow").attr("height","200%");v.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",3).attr("result","blur"),v.append("feOffset").attr("in","blur").attr("dx",-2).attr("dy",2).attr("result","offsetBlur");var A,w,N=v.append("feMerge");N.append("feMergeNode").attr("in","offsetBlur"),N.append("feMergeNode").attr("in","SourceGraphic"),u.on("mousemove",(function(){var a=c.brushActive?d3.mouse(d3.select(".background").node()):d3.mouse(u.node()),r=Math.round(S(a[0]));n.positionWithoutLetter||(r+=t[r-1]||""),$(e+" #zoomPosition").text(r)})),void 0!==n.dottedSequence&&(c.dottedSequence=n.dottedSequence),n.showSequence&&!i&&(c.showSequence=!0,D(p.end-p.start)?et.sequence(t.substring(p.start-1,p.end),g,p.start):et.sequenceLine(),o.push({data:t,name:"Sequence",className:"AA",color:"black",type:"text"}),x.push({title:"Sequence",y:g-8})),n.showAxis&&(A=g,u.append("g").attr("class","x axis Xaxis").attr("transform","translate(0,"+(A+20)+")").call(Z)),h=d.append("g").attr("class","pro axis").attr("transform","translate(0,"+k+")"),P(),n.brushActive&&(c.brushActive=!0,u.append("g").attr("class","brush").call(ct).selectAll("rect").attr("height",g+50)),n.verticalLine&&(c.verticalLine=!0,w=d3.select(".chart").append("div").attr("class","Vline").style("position","absolute").style("z-index","19").style("width","1px").style("height",g+50+"px").style("top","30px").style("background","#000"),d3.select(".chart").on("mousemove.Vline",(function(){mousex=d3.mouse(this)[0]-2,w.style("left",mousex+"px")}))),j(g)}(e,n),this.addFeature=function(t){var e;g+=20,o.push(t),et.typeIdentifier(t),P(),e=g,u.selectAll(".Xaxis").attr("transform","translate(0,"+(e+20)+")"),j(g),c.brushActive&&u.selectAll(".brush rect").attr("height",g+50),c.verticalLine&&d3.selectAll(".Vline").style("height",g+50+"px"),d3.selectAll(".element")[0].length>1500&&(E=!1)},this.clearInstance=function(){$(window).off("resize",dt),d=null,r=null,u=null,f=null,h=null,o=null,sbcRip=null,d3.helper={}}})}},e={};var n=function n(a){var r=e[a];if(void 0!==r)return r.exports;var l=e[a]={exports:{}};return t[a](l,l.exports,n),l.exports}(228);FeatureViewer=n}();