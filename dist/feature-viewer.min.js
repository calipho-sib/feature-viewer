var FeatureViewer;!function(){var t={228:function(t){"object"==typeof t.exports&&(t.exports=function(t,e,n){var a=this;this.events={FEATURE_SELECTED_EVENT:"feature-viewer-position-selected",FEATURE_DESELECTED_EVENT:"feature-viewer-position-deselected",ZOOM_EVENT:"feature-viewer-zoom-altered"};var r,i=document.getElementById(e.substring(1)),l=Number.isInteger(t)?t:null,s=l|t.length,o=[],p={showSequence:!1,brushActive:!1,verticalLine:!1,dottedSequence:!0},c={start:1,end:s};n&&n.offset&&(c=n.offset).start<1&&(c.start=1,console.warn("WARNING ! offset.start should be > 0. Thus, it has been reset to 1."));var d,u,h,y,f=0,x=[],m=20,g=0,v=0,w=50,b={length:c.end-c.start,start:c.start,end:c.end},A={},E=!0,N=[];function k(t,e){A!=={}&&d3.select(A.id).style("fill",A.originalColor),"path"!==e.type&&"line"!==e.type&&(A={id:t,originalColor:d3.select(t).style("fill")||e.color},d3.select(t).style("fill","orangered"))}d3.select(e).style("position","relative").style("padding","0px").style("z-index","2");var V=10,z=20,T=20,C=110,q=$(e).width()-C-z-17,L=600-V-T,S=d3.scale.linear().domain([c.start,c.end]).range([5,q-5]),_=d3.scale.linear().domain([0,q]).range([c.start,c.end]);function P(t,e){for(var n=t-110,a="",r=0;r<e.length;r++)if(S(e[r].x)<n&&S(e[r+1].x)>n){a=n-S(e[r].x)<S(e[r+1].x)-n?e[r]:e[r+1];break}return a}d3.helper={},d3.helper.tooltip=function(t){var i,l,s=d3.select(e).node(),o=n.tooltipColor?n.tooltipColor:"orangered";function c(n){n.on("mouseover.tooltip",(function(n,a){d3.select("body").selectAll("div.tooltip").remove();var r=d3.mouse(s),l=r[0]>q;if(l?i=d3.select(e).append("div").attr("class","tooltip3"):(i=d3.select(e).append("div").attr("class","tooltip2")).style({left:r[0]-15+"px"}),i.style({bottom:s.offsetHeight-r[1]+16+"px","background-color":"#eee",width:"auto","max-width":"170px",height:"auto","max-height":"68px",padding:"5px",font:"10px sans-serif","text-align":"center",position:"absolute","z-index":45,"box-shadow":"0 1px 2px 0 #656565"}),"path"===t.type){var p='<p style="margin:2px;font-weight:700;color:'+o+'">'+n[0].x+"&#x256d;&#x256e;"+n[1].x+"</p>";if(n.description)var c='<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>";else c=""}else if("line"===t.type){var d=P(r[0],n);d.description?(p='<p style="margin:2px;font-weight:700;color:'+o+'">'+d.x+" : <span> "+d.y+"</span></p>",c='<p style="margin:2px;color:'+o+';font-size:9px">'+d.description+"</p>"):(p='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+d.x+"</span></p>",c='<p style="margin:2px;color:'+o+'">count : <span id="tLineC">'+d.y+"</span></p>")}else"bar"===t.type?n.description?p='<p style="margin:2px;font-weight:700;color:'+o+';font-size:9px">'+n.description+"</p>":(p='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+n.x+"</span></p>",c='<p style="margin:2px;color:'+o+'">frequency : <span id="tLineC">'+(n.absoluteY?n.absoluteY:n.y)+"</span></p>"):"unique"===t.type||n.x===n.y?(p='<p style="margin:2px;font-weight:700;color:'+o+'">'+n.x+"</p>",c=n.description?'<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>":""):(p='<p style="margin:2px;font-weight:700;color:'+o+'">'+n.x+" - "+n.y+"</p>",c=n.description?'<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>":"");c?i.html(p+c):i.html(p),l&&i.style({left:r[0]+10-i.node().getBoundingClientRect().width+"px"})})).on("mousemove.tooltip",(function(e,n){if("line"===t.type){var a=P((p=d3.mouse(s))[0],e);if(a.description)var r='<p style="margin:2px;color:'+o+'">'+a.x+" : <span> "+a.y+"</span></p>",l='<p style="margin:2px;color:'+o+';font-size:9px">'+a.description+"</p>";else r='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+a.x+"</span></p>",l='<p style="margin:2px;color:'+o+'">count : <span id="tLineC">'+a.y+"</span></p>";i.html(r+l)}var p;void 0!==i&&((p=d3.mouse(s))[0]>q?(i.attr("class","tooltip3"),i.style({left:p[0]+10-i.node().getBoundingClientRect().width+"px",bottom:s.offsetHeight-p[1]+16+"px"})):(i.attr("class","tooltip2"),i.style({left:p[0]-15+"px",bottom:s.offsetHeight-p[1]+16+"px"})))})).on("mouseout.tooltip",(function(t,e){i.remove()})).on("click",(function(n,i){var o,c,d,h,y;if("text"===this.nodeName){var f="#"+this.previousSibling.id;"#"!==f.nodeName&&k(f,t)}else k(this,t);var x=p.brushActive?d3.select(".background").attr("width"):u.node().getBBox().width;if(d3.select("body").selectAll("div.selectedRect").remove(),l=d3.select(e).append("div").attr("class","selectedRect"),"path"===t.type?(o=n[0].x,c=n[1].x):"line"===t.type?(o=(y=P(d3.mouse(s)[0],n)).x-.5,c=y.x+.5):"unique"===t.type||n.x===n.y?(o=n.x-.4,c=n.y+.4):(o=n.x,c=n.y),S(o)<0&&S(c)>x?(d=C,h=parseInt(x)+5):S(o)<0?(d=C,h=S(c)):S(c)>x?(d=S(o)+C,h=parseInt(x)-S(o),h+=5):(d=S(o)+C,h=S(c)-S(o)),l.style({left:d+"px",top:$(e+" .svgHeader").length?"60px":"10px","background-color":"rgba(0, 0, 0, 0.2)",width:h+"px",height:m+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"}),CustomEvent){var g=new CustomEvent(a.events.FEATURE_SELECTED_EVENT,{detail:{start:"path"===t.type?n[0].x:"line"===t.type?y.x:n.x,end:"path"===t.type?n[1].x:"line"===t.type?y.y:n.y,id:"path"===t.type?n[0].id:"line"===t.type?y.id:n.id,description:"path"===t.type?n[0].description:"line"===t.type?y.description:n.description}});r.dispatchEvent(g)}else console.warn("CustomEvent is not defined....");a.trigger&&a.trigger(a.events.FEATURE_SELECTED_EVENT,{start:"path"===t.type?n[0].x:"line"===t.type?y.x:n.x,end:"path"===t.type?n[1].x:"line"===t.type?y.y:n.y,id:"path"===t.type?n[0].id:"line"===t.type?y.id:n.id,description:"path"===t.type?n[0].description:"line"===t.type?y.description:n.description})}))}return c.attr=function(t){return arguments.length?(attrs=t,this):attrs},c.style=function(t){return arguments.length?(styles=t,this):styles},c};var R=function(t){return S(t.x)},F=function(t){return q/t>5},D=function(t){return S(t.y)-S(t.x)};function M(t){return t.x===t.y?S(t.x-.4):S(t.x)}function O(t){return t.x===t.y?S(t.x+.4)-S(t.x-.4)<2?2:S(t.x+.4)-S(t.x-.4):S(t.y)-S(t.x)}function I(t){var e=[];return t.forEach((function(t){if(e===[])e.push(t.y),t.level=0;else{for(var n=!1,a=0;a<e.length;a++)if(t.x>e[a]){n=!0,t.level=a,e[a]=t.y;break}!1===n&&(e.push(t.y),t.level=e.length-1)}})),e.length}this.onFeatureSelected=function(t){r.addEventListener(a.events.FEATURE_SELECTED_EVENT,t)},this.onFeatureDeselected=function(t){r.addEventListener(a.events.FEATURE_DESELECTED_EVENT,t)},this.onZoom=function(t){r.addEventListener(a.events.ZOOM_EVENT,t)};var B=d3.svg.line().interpolate("step-before").x((function(t){return S(t.x)})).y((function(t){return 10*-t.y+f})),G=d3.svg.line().x((function(t){return S(t.x)})).y((function(t){return 10*H(-t.y)+f})),H=d3.scale.linear().domain([0,-30]).range([0,-20]),U=d3.svg.line().interpolate("linear").x((function(t){return S(t.x)})).y((function(t){return t.y+6})),X=d3.svg.axis().scale(S).tickFormat(d3.format("d")).orient("bottom");function Z(t,e,n){if("number"!=typeof t||t<-1||t>1||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||"string"!=typeof n&&void 0!==n)return null;this.sbcRip||(this.sbcRip=function(t){var e=t.length,n=new Object;if(e>9){if((t=t.split(",")).length<3||t.length>4)return null;n[0]=a(t[0].slice(4)),n[1]=a(t[1]),n[2]=a(t[2]),n[3]=t[3]?parseFloat(t[3]):-1}else{if(8==e||6==e||e<4)return null;e<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(e>4?t[4]+""+t[4]:"")),t=a(t.slice(1),16),n[0]=t>>16&255,n[1]=t>>8&255,n[2]=255&t,n[3]=9==e||5==e?r((t>>24&255)/255*1e4)/1e4:-1}return n});var a=parseInt,r=Math.round,i=e.length>9,l=(i="string"==typeof n?n.length>9||"c"==n&&!i:i,t<0),s=(t=l?-1*t:t,n=n&&"c"!=n?n:l?"#000000":"#FFFFFF",sbcRip(e)),o=sbcRip(n);return s&&o?i?"rgb("+r((o[0]-s[0])*t+s[0])+","+r((o[1]-s[1])*t+s[1])+","+r((o[2]-s[2])*t+s[2])+(s[3]<0&&o[3]<0?")":","+(s[3]>-1&&o[3]>-1?r(1e4*((o[3]-s[3])*t+s[3]))/1e4:o[3]<0?s[3]:o[3])+")"):"#"+(4294967296+16777216*(s[3]>-1&&o[3]>-1?r(255*((o[3]-s[3])*t+s[3])):o[3]>-1?r(255*o[3]):s[3]>-1?r(255*s[3]):255)+65536*r((o[0]-s[0])*t+s[0])+256*r((o[1]-s[1])*t+s[1])+r((o[2]-s[2])*t+s[2])).toString(16).slice(s[3]>-1||o[3]>-1?1:3):null}function j(t){d.attr("height",t+60+"px"),d.select("clippath rect").attr("height",t+60+"px")}var Y=d3.scale.ordinal().domain([0,x.length]).rangeRoundBands([0,500],.1);function J(){(y=h.selectAll(".yaxis").data(x).enter().append("g")).append("polygon").attr("class",(function(t){return t.filter?t.filter.split(" ").join("_")+"Arrow":"Arrow"})).style("stroke","").style("fill","#DFD5D3").attr("points",(function(t){return C-105+","+(t.y-3)+", "+(C-105)+","+(t.y+12)+", "+(C-15)+","+(t.y+12)+", "+(C-7)+","+(t.y+4.5)+", "+(C-15)+","+(t.y-3)})),y.append("text").attr("class","yaxis").attr("text-anchor","start").attr("x",(function(){return C-102})).attr("y",(function(t){return t.y+8})).text((function(t){return t.title}))}function W(t){t.on("mousedown",(function(){brush_elm=d.select(".brush").node(),new_click_event=new Event("mousedown"),new_click_event.pageX=d3.event.pageX,new_click_event.clientX=d3.event.clientX,new_click_event.pageY=d3.event.pageY,new_click_event.clientY=d3.event.clientY,brush_elm&&brush_elm.dispatchEvent(new_click_event)}))}d3.svg.axis().scale(Y).tickValues(x).tickFormat((function(t){return t})).orient("left");var K=function(t){t.data.sort((function(t,e){return t.x-e.x}));var e=I(t.data);t.data=t.data.map((function(t){return[{x:t.x,y:0,id:t.id,description:t.description,color:t.color},{x:t.y,y:t.level+1,id:t.id},{x:t.y,y:0,id:t.id}]})),f=10*e+5,t.height=10*e+5},Q=function(t){t.height||(t.height=10);var e=parseInt(t.height),n=0;for(var a in t.data){t.data[a].sort((function(t,e){return t.x-e.x})),0!==t.data[a][0].y&&t.data[a].unshift({x:t.data[a][0].x-1,y:0}),0!==t.data[a][t.data[a].length-1].y&&t.data[a].push({x:t.data[a][t.data[a].length-1].x+1,y:0});var r=Math.max.apply(Math,t.data[a].map((function(t){return Math.abs(t.y)})));n=r>n?r:n,t.data[a]=[t.data[a].map((function(t){return{x:t.x,y:t.y,id:t.id,description:t.description}}))]}H.range([0,-e]).domain([0,-n]),f=10*e+5,t.level=n,t.shift=10*e+5},tt=function(t){t.height||(t.height=10);var e=parseInt(t.height),n=0;for(var a in t.data){t.data[a].sort((function(t,e){return t.x-e.x})),0!==t.data[a][0].y&&t.data[a].unshift({x:t.data[a][0].x-1,y:0}),0!==t.data[a][t.data[a].length-1].y&&t.data[a].push({x:t.data[a][t.data[a].length-1].x+1,y:0});var r=Math.max.apply(Math,t.data[a].map((function(t){return Math.abs(t.y)})));n=r>n?r:n}H.range([0,-e]).domain([0,-n]),f=10*e+5,t.maxValue=r,t.level=n,t.shift=10*e+5},et=function(t){t.data.sort((function(t,e){return t.x-e.x})),t.highlight&&Array.isArray(t.highlight)&&t.highlight.forEach((function(e){for(var n in t.data)e.x==t.data[n].x&&e.y==t.data[n].y&&(t.data[n].highlight=!0,t.data[n].color=e.color,t.data[n].description=e.highlightText)})),g=I(t.data),f=10*g+5},nt={typeIdentifier:function(t,e){if("rect"===t.type)et(t),x.push({title:t.name,y:m,filter:t.filter}),nt.rectangle(t,m,e);else if("text"===t.type)nt.sequence(t.data,m),x.push({title:t.name,y:m,filter:t.filter}),S.range([5,q-5]);else if("unique"===t.type)nt.unique(t,m),x.push({title:t.name,y:m,filter:t.filter});else if("multipleRect"===t.type)et(t),nt.multipleRect(t,m,g),x.push({title:t.name,y:m,filter:t.filter}),m+=10*(g-1);else if("path"===t.type)K(t),nt.path(t,m),m+=f,x.push({title:t.name,y:m-10,filter:t.filter});else if("line"===t.type){Array.isArray(t.data[0])||(t.data=[t.data]),Array.isArray(t.color)||(t.color=[t.color]);var n=!1;t.data.forEach((function(t){t.filter((function(t){return t.y<0})).length&&(n=!0)})),Q(t),nt.line(t,m),m+=f,x.push({title:t.name,y:m-10,filter:t.filter}),m+=n?f-5:0}else"bar"===t.type&&(Array.isArray(t.data[0])||(t.data=[t.data]),Array.isArray(t.color)||(t.color=[t.color]),n=!1,t.data.forEach((function(t){t.filter((function(t){return t.y<0})).length&&(n=!0)})),tt(t),nt.bar(t,m,e),m+=f,x.push({title:t.name,y:m-10,filter:t.filter}),m+=n?f-5:0)},sequence:function(t,e,n){n||(n=0),u.append("g").attr("class","seqGroup").selectAll(".AA").data(t).enter().append("text").attr("clip-path","url(#clip)").attr("class","AA").attr("text-anchor","middle").attr("x",(function(t,e){return S.range([5,q-5])(e+n)})).attr("y",e).attr("font-size","10px").attr("font-family","monospace").text((function(t,e){return t}))},sequenceLine:function(){p.dottedSequence&&u.selectAll(".sequenceLine").data([[{x:1,y:12},{x:s,y:12}]]).enter().append("path").attr("clip-path","url(#clip)").attr("d",U).attr("class","sequenceLine").style("z-index","0").style("stroke","black").style("stroke-dasharray","1,3").style("stroke-width","1px").style("stroke-opacity",0).transition().duration(500).style("stroke-opacity",1)},rectangle:function(t,e,n){t.height||(t.height=12),t.showDescriptionRect||(t.showDescriptionRect=!0),t.summaryView||(t.summaryView=!1),t.summaryViewProperties||(t.summaryViewProperties={}),t.summaryViewProperties.buttonColor||(t.summaryViewProperties.buttonColor="#5789d4"),t.summaryViewProperties.buttonTextColor||(t.summaryViewProperties.buttonTextColor="#ffffff"),t.summaryViewProperties.buttonLabel||(t.summaryViewProperties.buttonLabel="Click Here to Load All Data"),t.summaryViewProperties.position||(t.summaryViewProperties.position="left");let a=0;a="left"===t.summaryViewProperties.position?2:"right"===t.summaryViewProperties.position?s/8*6.6-2:"center"===t.summaryViewProperties.position?s/8*3.5-2:2;for(var r=t.height,i=r+r/3,l=r/2-6,o=u.append("g").attr("class","rectangle").attr("clip-path","url(#clip)").attr("transform","translate(0,"+e+")"),p=[],c=0;c<g;c++)p.push([{x:1,y:c*i+l},{x:s,y:c*i+l}]);if(o.selectAll(".line"+t.className).data(p).enter().append("path").attr("d",U).attr("class",(function(){return"line"+t.className})).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),t.summaryView)o.selectAll("rectbox").data([10]).enter().append("rect").attr("width",s/8).attr("height",15).attr("x",a).attr("y",l-10).attr("fill",t.summaryViewProperties.buttonColor).on("click",n),o.append("text").attr("x",a+s/80).attr("y",l+1).attr("font-size","10px").attr("fill",t.summaryViewProperties.buttonTextColor).text(t.summaryViewProperties.buttonLabel).on("click",n);else{var d=o.selectAll("."+t.className+"Group").data(t.data).enter().append("g").attr("class",t.className+"Group").attr("transform",(function(t){return"translate("+M(t)+",0)"}));d.append("rect").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("y",(function(t){return t.level*i})).attr("width",O).attr("height",r).style("fill",(function(e){return e.color||t.color})).style("z-index","13").call(d3.helper.tooltip(t)),t.showDescriptionRect&&d.append("text").attr("class","element "+t.className+"Text").attr("y",(function(t){return t.level*i+r/2})).attr("dy","0.35em").style("font-size","10px").text((function(t){return t.description})).style("fill","black").style("z-index","15").style("visibility",(function(t){return t.description&&S(t.y)-S(t.x)>8*t.description.length&&r>11?"visible":"hidden"})).call(d3.helper.tooltip(t)),W(d);var h=r>12?r-6:0;m+=g<2?h:(g-1)*i+h}},unique:function(t,e){var n=u.append("g").attr("class","uniquePosition").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:s,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",U).attr("class","line"+t.className).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),n.selectAll("."+t.className).data(t.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("x",(function(t){return S(t.x-.4)})).attr("width",(function(t){return S(t.x+.4)-S(t.x-.4)<2?2:S(t.x+.4)-S(t.x-.4)})).attr("height",12).style("fill",(function(e){return e.color||t.color})).style("z-index","3").call(d3.helper.tooltip(t)),W(n)},path:function(t,e){var n=u.append("g").attr("class","pathing").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:s,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",B).attr("class","line"+t.className).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),n.selectAll("."+t.className).data(t.data).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t[0].id})).attr("d",B).style("fill","none").style("stroke",(function(e){return e[0].color||t.color})).style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(t)),W(n)},line:function(t,e){t.interpolation||(t.interpolation="monotone"),void 0===t.fill&&(t.fill=!0);var n=u.append("g").attr("class","lining").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:s,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",B).attr("class","line"+t.className).style("z-index","0").style("stroke","black").style("stroke-width","1px"),t.data.forEach((function(e,a,r){n.selectAll("."+t.className+a).data(e).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+t.className+" "+t.className+a).attr("d",G.interpolate(t.interpolation)).style("fill",t.fill?Z(.6,t.color[a])||Z(.6,"#000"):"none").style("stroke",t.color[a]||"#000").style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(t))})),W(n)},bar:function(t,e,n){void 0===t.fill&&(t.fill=!0),t.summaryView||(t.summaryView=!1),t.summaryViewProperties||(t.summaryViewProperties={}),t.summaryViewProperties.buttonColor||(t.summaryViewProperties.buttonColor="#5789d4"),t.summaryViewProperties.buttonTextColor||(t.summaryViewProperties.buttonTextColor="#ffffff"),t.summaryViewProperties.buttonLabel||(t.summaryViewProperties.buttonLabel="Click Here to Load All Data"),t.summaryViewProperties.position||(t.summaryViewProperties.position="left");let a=0;a="left"===t.summaryViewProperties.position?2:"right"===t.summaryViewProperties.position?s/6*4.7-2:"center"===t.summaryViewProperties.position?s/6*2.5:2;var r=u.append("g").attr("class","bar").attr("clip-path","url(#clip)").attr("transform","translate(0,"+e+")"),i=[];i.push([{x:1,y:0},{x:s,y:0}]);var l=d3.scale.linear().domain([0,t.maxValue]).range([0,t.shift]);r.selectAll(".line"+t.className).data(i).enter().append("path").attr("clip-path","url(#clip)").attr("d",G).attr("class","line"+t.className).style("z-index","0").style("stroke","black").style("stroke-width","1px"),t.summaryView?(r.selectAll("rectbox").data([10]).enter().append("rect").attr("width",s/6).attr("height",25).attr("x",a).attr("y",t.shift-25).attr("fill",t.summaryViewProperties.buttonColor).on("click",n),r.append("text").attr("x",a+s/60).attr("y",t.shift-12).attr("dy",".35em").attr("fill",t.summaryViewProperties.buttonTextColor).text(t.summaryViewProperties.buttonLabel).on("click",n)):t.data.forEach((function(e,n,a){r.selectAll().data(e).enter().append("rect").attr("class","element "+t.className).attr("x",(function(t){return S(t.x-.4)})).attr("width",(function(t){return S(t.x+.4)-S(t.x-.4)<2?2:S(t.x+.4)-S(t.x-.4)})).attr("y",(function(e){return t.shift-l(e.y)})).attr("height",(function(t){return l(t.y)})).style("fill",(function(e){return e.color||t.color})).style("z-index","3").call(d3.helper.tooltip(t))})),W(r)},multipleRect:function(t,e,n){for(var a=u.append("g").attr("class","multipleRects").attr("transform","translate(0,"+e+")"),r=0;r<n;r++)a.append("path").attr("d",U([{x:1,y:10*r-2},{x:s,y:10*r-2}])).attr("class",(function(){return"line"+t.className})).style("z-index","0").style("stroke",t.color).style("stroke-width","1px");a.selectAll("."+t.className).data(t.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("x",R).attr("y",(function(t){return 10*t.level})).attr("width",D).attr("height",8).style("fill",(function(e){return e.color||t.color})).style("z-index","13").call(d3.helper.tooltip(t)),W(a)}};this.showFilteredFeature=function(t,e,n){h.selectAll("."+t+"Arrow");var a=C-105,r=C-7,i=d.append("linearGradient").attr("y1","0").attr("y2","0").attr("x1",a).attr("x2",r).attr("id","gradient").attr("spreadMethod","pad").attr("gradientUnits","userSpaceOnUse");i.append("stop").attr("offset","0.3").attr("stop-color","#DFD5D3").attr("stop-opacity",1),i.append("stop").attr("offset","1").attr("stop-opacity",1).attr("stop-color","#DFD5D3").attr("stop-color",e);var l="url(#gradient)",s="url(#dropshadow)";n&&(l="url("+n+"#gradient)",s="url("+n+"#dropshadow)"),h.selectAll("."+t+"Arrow").style("fill",l).style("stroke","").attr("filter",s).attr("points",(function(t){return C-105+","+(t.y-3)+", "+(C-105)+","+(t.y+12)+", "+(C-10)+","+(t.y+12)+", "+(C-2)+","+(t.y+4.5)+", "+(C-10)+","+(t.y-3)}))},this.hideFilteredFeature=function(t){h.selectAll("."+t+"Arrow").style("fill","rgba(95,46,38,0.2)").attr("filter","").attr("points",(function(t){return C-105+","+(t.y-3)+", "+(C-105)+","+(t.y+12)+", "+(C-15)+","+(t.y+12)+", "+(C-7)+","+(t.y+4.5)+", "+(C-15)+","+(t.y-3)}))};var at=function(t){u.selectAll(".line"+t.className).attr("d",U.x((function(t){return S(t.x)}))),E?(transit1=u.selectAll("."+t.className+"Group").transition().duration(500),transit2=u.selectAll("."+t.className).transition().duration(500)):(transit1=u.selectAll("."+t.className+"Group"),transit2=u.selectAll("."+t.className)),transit1.attr("transform",(function(t){return"translate("+M(t)+",0)"})),transit2.attr("width",O),u.selectAll("."+t.className+"Text").style("visibility",(function(e){return e.description&&S(e.y)-S(e.x)>8*e.description.length&&t.height>11?"visible":"hidden"}))},rt=function(t){u.selectAll("."+t.className).attr("x",(function(t){return S(t.x)})).attr("width",(function(t){return S(t.y)-S(t.x)}))},it=function(t){u.selectAll(".line"+t.className).attr("d",U.x((function(t){return S(t.x)}))),(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("x",(function(t){return S(t.x-.4)})).attr("width",(function(t){return S(t.x+.4)-S(t.x-.4)<2?2:S(t.x+.4)-S(t.x-.4)}))},lt=function(t){u.selectAll(".line"+t.className).attr("d",B.x((function(t){return S(t.x)})).y((function(e){return 10*-e.y+t.height}))),(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("d",B.y((function(e){return 10*-e.y+t.height})))},st=function(t){H.range([0,-t.height]).domain([0,-t.level]),u.selectAll(".line"+t.className).attr("d",G.y((function(e){return 10*H(-e.y)+t.shift}))),(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("d",G.y((function(e){return 10*H(-e.y)+t.shift})).interpolate(t.interpolation))},ot=function(t){(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("x",(function(t){return S(t.x-.4)})).attr("width",(function(t){return S(t.x+.4)-S(t.x-.4)<2?2:S(t.x+.4)-S(t.x-.4)}))},pt=function(t,e){(E?u.selectAll("."+t.className).transition().duration(500):u.selectAll("."+t.className)).attr("x",(function(t,n){return S(n+e)}))},ct=d3.svg.brush().x(S).on("brushend",dt);function dt(){if(d3.select(e).selectAll("div.selectedRect").remove(),0!==Object.keys(A).length&&A.constructor===Object){if(d3.select(A.id).style("fill",A.originalColor),A={},CustomEvent){var n=new CustomEvent(a.events.FEATURE_DESELECTED_EVENT,{detail:{info:"feature-deselected"}});r.dispatchEvent(n)}else console.warn("CustomEvent is not defined....");a.trigger&&a.trigger(a.events.FEATURE_DESELECTED_EVENT,{info:"feature-deselected"})}var i=ct.extent(),d=Math.abs(i[0]-i[1]);if(i[0]<i[1])var h=parseInt(i[0]-1),y=parseInt(i[1]+1);else h=parseInt(i[1]+1),y=parseInt(i[0]-1);var f=F(d);if(!ct.empty()&&d>w){b.length=d;var x=(s/d).toFixed(1);$(e+" .zoomUnit").text(x.toString()),p.showSequence&&!l&&f&&u.selectAll(".AA").empty()&&(b={length:d,start:h,end:y},v=h,u.selectAll(".sequenceLine").remove(),nt.sequence(t.substring(h-1,y),20,v-1)),S.domain(i),_.range(i);var m=v||c.start;yt(o,m),ft(),CustomEvent&&r.dispatchEvent(new CustomEvent(a.events.ZOOM_EVENT,{detail:{start:h,end:y,zoom:x}})),a.trigger&&a.trigger(a.events.ZOOM_EVENT,{start:h,end:y,zoom:x}),d3.select(e).selectAll(".brush").call(ct.clear())}else d3.select(e).selectAll(".brush").call(ct.clear())}this.zoom=function(t,e){b.start<t&&b.end>e||u.selectAll(".seqGroup").remove(),ct.extent([t,e]),dt()},this.resetZoom=function(t,e){ht()};var ut=function(){!function(){q=$(e).width()-C-z-17,d3.select(e+" svg").attr("width",q+C+z),d3.select(e+" #clip>rect").attr("width",q),p.brushActive&&d3.select(e+" .background").attr("width",q),d3.select(e).selectAll(".brush").call(ct.clear());var n=F(b.length);p.showSequence&&!l&&(!1!==n||u.selectAll(".AA").empty()?!0===n&&u.selectAll(".AA").empty()&&(u.selectAll(".sequenceLine").remove(),nt.sequence(t.substring(b.start-1,b.end),20,b.start-1)):(u.selectAll(".seqGroup").remove(),nt.sequenceLine())),S.range([5,q-5]),_.domain([0,q]),yt(o,b.start),ft()}()};function ht(){$(".zoomUnit").text("1"),S.domain([c.start,c.end]),_.range([c.start,c.end]);var n=F(c.end-c.start);p.showSequence&&!l&&(!1!==n||u.selectAll(".AA").empty()?b.length===s||!0!==n||u.selectAll(".AA").empty()||(u.selectAll(".seqGroup").remove(),nt.sequence(t.substring(c.start-1,c.end),20,c.start)):(u.selectAll(".seqGroup").remove(),nt.sequenceLine())),b={length:c.end-c.start,start:c.start,end:c.end},v=0,yt(o,c.start),ft(),CustomEvent&&r.dispatchEvent(new CustomEvent(a.events.ZOOM_EVENT,{detail:{start:1,end:t.length,zoom:1}})),a.trigger&&a.trigger(a.events.ZOOM_EVENT,{start:1,end:t.length,zoom:1}),d3.select(e).selectAll(".brush").call(ct.clear())}function yt(t,e){t.forEach((function(t){"rect"===t.type?at(t):"multipleRect"===t.type?rt(t):"unique"===t.type?it(t):"path"===t.type?lt(t):"line"===t.type?st(t):"text"===t.type?pt(t,e):"bar"===t.type&&ot(t,e)}))}function ft(){u.transition().duration(500).select(".x.axis").call(X)}function xt(e,n){if(void 0===n&&(n={showAxis:!1,showSequence:!1,brushActive:!1,verticalLine:!1,toolbar:!1,bubbleHelp:!1,showvariant:!1,unit:"units",zoomMax:50}),$.fn.popover||(n.bubbleHelp=!1,console.warn("The bubble help requires tooltip and popover bootstrap js libraries. The feature viewer will continue to work, but without the info bubble")),n.zoomMax&&(w=n.zoomMax),n.unit||(n.unit="units"),n.animation&&(E=n.animation),!0===n.toolbar){var a=$(e+" .svgHeader").length?d3.select(e+" .svgHeader"):d3.select(e).append("div").attr("class","svgHeader");if(!$(e+" .header-position").length){var s=a.append("div").attr("class","header-position").style("display","inline-block").style("margin","15px 10px 0px").style("padding","0px").style("line-height","32px");s.append("div").attr("class","position-label").style("padding","0px 5px").style("display","inline-block").style("padding","0px").style("font-weight","700").text("Position  :  "),s.append("div").style("display","inline-block").style("padding","0px").style("padding-left","5px").append("div").style("min-width","50px").attr("id","zoomPosition").text("0")}$(e+" .header-zoom").length||((y=a.append("div").attr("class","header-zoom").style("display","inline-block").style("margin","15px 0px 0px").style("padding","0px").style("line-height","32px")).append("div").attr("class","zoom-label").style("padding","0px 5px").style("display","inline-block").style("padding","0px").style("font-weight","700").text("Zoom : "),y.append("div").style("display","inline-block").style("padding","0px").append("div").style("min-width","50px").style("padding-left","5px").append("span").text("x ").append("span").attr("class","zoomUnit").text("1"));var y=$(e+" .header-zoom").length?d3.select(e+" .header-zoom"):a;if(!0===n.bubbleHelp&&!$(e+" .header-help").length){var f="<div><strong>To zoom in :</strong> Left click to select area of interest</div><div><strong>To zoom out :</strong> Right click to reset the scale</div><div><strong>Zoom max  :</strong> Limited to <strong>"+w.toString()+" "+n.unit+"</strong></div>";y.append("div").style("display","inline-block").style("margin","0px").style("margin-right","5px").style("padding","0px").append("a").attr("type","button").attr("class","header-help").attr("data-toggle","popover").attr("data-placement","auto left").attr("title","Help").attr("data-content",f).style("font-size","14px").append("span").attr("class","label label-as-badge label-info").style("font-weight","500").style("border-radius","3px").style("box-shadow","inset 0px 0px 4px rgba(0,0,0,0.10)").style("color","#fff").html("<span class='state'>Show</span> help"),$((function(){$('[data-toggle="popover"]').popover({html:!0}),$(e+" .header-help").on("hide.bs.popover",(function(){$(this).find(".state").text("Show")})),$(e+" .header-help").on("show.bs.popover",(function(){$(this).find(".state").text("Hide")}))}))}}d=d3.select(e).append("svg").attr("width",q+C+z).attr("height",L+V+T).style("z-index","2").on("contextmenu",(function(t,e){d3.event.preventDefault(),ht()})),r=i.getElementsByTagName("svg")[0];var g=(u=d.append("g").attr("transform","translate("+C+","+V+")")).append("defs");g.append("clipPath").attr("id","clip").append("rect").attr("width",q).attr("height",L);var v=g.append("filter").attr("id","dropshadow").attr("height","200%");v.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",3).attr("result","blur"),v.append("feOffset").attr("in","blur").attr("dx",-2).attr("dy",2).attr("result","offsetBlur");var b,A,N=v.append("feMerge");N.append("feMergeNode").attr("in","offsetBlur"),N.append("feMergeNode").attr("in","SourceGraphic"),u.on("mousemove",(function(){var a=p.brushActive?d3.mouse(d3.select(".background").node()):d3.mouse(u.node()),r=Math.round(_(a[0]));n.positionWithoutLetter||(r+=t[r-1]||""),$(e+" #zoomPosition").text(r)})),void 0!==n.dottedSequence&&(p.dottedSequence=n.dottedSequence),n.showSequence&&!l&&(p.showSequence=!0,F(c.end-c.start)?nt.sequence(t.substring(c.start-1,c.end),m,c.start):nt.sequenceLine(),o.push({data:t,name:"Sequence",className:"AA",color:"black",type:"text"}),x.push({title:"Sequence",y:m-8})),n.showAxis&&(b=m,u.append("g").attr("class","x axis Xaxis").attr("transform","translate(0,"+(b+20)+")").call(X)),h=d.append("g").attr("class","pro axis").attr("transform","translate(0,"+V+")"),J(),n.brushActive&&(p.brushActive=!0,u.append("g").attr("class","brush").call(ct).selectAll("rect").attr("height",m+50)),n.verticalLine&&(p.verticalLine=!0,A=d3.select(".chart").append("div").attr("class","Vline").style("position","absolute").style("z-index","19").style("width","1px").style("height",m+50+"px").style("top","30px").style("background","#000"),d3.select(".chart").on("mousemove.Vline",(function(){mousex=d3.mouse(this)[0]-2,A.style("left",mousex+"px")}))),j(m)}$(window).on("resize",ut),this.addRectSelection=function(t){var n,a,r,i,l=d3.select(t),s=l.data(),o=p.brushActive?d3.select(".background").attr("width"):u.node().getBBox().width;d3.select("body").selectAll("div.selectedRect").remove(),k(t,{type:l[0][0].tagName,color:l.style("fill")});var c=d3.select(e).append("div").attr("class","selectedRect");3===s[0].length?(n=s[0][0].x,a=s[0][1].x):s[0].x===s[0].y?(n=s[0].x-.5,a=s[0].y+.5):(n=s[0].x,a=s[0].y),S(n)<0?(r=C,i=S(a)):S(a)>o?(r=S(n)+C,i=o-S(n)):(r=S(n)+C,i=S(a)-S(n)),c.style({left:r+"px",top:"60px","background-color":"rgba(0, 0, 0, 0.2)",width:i+"px",height:m+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"})},xt(e,n),this.addFeature=function(t,e){!t.summaryView||void 0!==t.data&&0!==t.data.length||(t.data=[{x:10,y:15}]);const n=JSON.parse(JSON.stringify(t));var a;N.push(n),m+=20,o.push(t),nt.typeIdentifier(t,e),J(),a=m,u.selectAll(".Xaxis").attr("transform","translate(0,"+(a+20)+")"),j(m),p.brushActive&&u.selectAll(".brush rect").attr("height",m+50),p.verticalLine&&d3.selectAll(".Vline").style("height",m+50+"px"),d3.selectAll(".element")[0].length>1500&&(E=!1)},this.loadSummaryFeature=function(t){let a=N;N=[];let r=e;e.includes("#")&&(r=e.split("#")[1]);let i=document.getElementById(r),l=i.getElementsByTagName("svg");i.removeChild(l[0]),m=20,x=[],o=[],d3.select(e).style("position","relative").style("padding","0px").style("z-index","2"),xt(e,n),a.forEach((e=>{e.className==t.className&&(e.summaryView=!1,e.data=t.data),this.addFeature(e)}))},this.clearInstance=function(){$(window).off("resize",ut),d=null,r=null,u=null,y=null,h=null,o=null,sbcRip=null,d3.helper={}},this.downloadSVG=function(){let t=e;e.includes("#")&&(t=e.split("#")[1]);let n=document.getElementById(t).getElementsByTagName("svg")[0],a=(new XMLSerializer).serializeToString(n);a.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(a=a.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),a.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)||(a=a.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),a='<?xml version="1.0" standalone="no"?>\r\n'+a;let r="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a),i=document.createElement("a");i.setAttribute("download","feature-viewer.svg"),i.href=r,document.body.appendChild(i),i.click(),i.remove()}})}},e={};var n=function n(a){var r=e[a];if(void 0!==r)return r.exports;var i=e[a]={exports:{}};return t[a](i,i.exports,n),i.exports}(228);FeatureViewer=n}();