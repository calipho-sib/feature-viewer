var FeatureViewer;(()=>{var t={412:(t,e,n)=>{"use strict";n.r(e),n.d(e,{toast:()=>r});const a={ERROR:"Original cannot be same as Variant",SUCCESS:"Variant added successfully!"};var i=n(290);function r(t,e,n){t?($(n).html(`${"error"===e?i.errorIcon:i.successIcon}\n        <p class='${e}'>${"error"===e?a.ERROR:a.SUCCESS}</p>`),$(n).show(),"success"===e&&setTimeout((()=>{$(n).hide()}),2e3)):$(n).hide()}},228:(t,e,n)=>{const{crossIcon:a,deleteIcon:r,bottomArrowIcon:o}=n(290),{dropdownOptions:l}=n(802),{toast:s}=n(412);"object"==typeof t.exports&&(t.exports=function(t,e,n){var c=this;this.events={FEATURE_SELECTED_EVENT:"feature-viewer-position-selected",FEATURE_DESELECTED_EVENT:"feature-viewer-position-deselected",ZOOM_EVENT:"feature-viewer-zoom-altered",GET_PREDICTIONS_EVENT:"feature-viewer-vep-predictions",VARIANT_ADDED_EVENT:"feature-viewer-variant-added"};var p,u=document.getElementById(e.substring(1)),h=Number.isInteger(t)?t:null,f=h|t.length,x=[],m={showSequence:!1,brushActive:!1,verticalLine:!1,dottedSequence:!0,variant:!1},y={start:1,end:f};n&&n.offset&&(y=n.offset).start<1&&(y.start=1,console.warn("WARNING ! offset.start should be > 0. Thus, it has been reset to 1."));var g,v,w,b,A=0,E=[],C=20,k=0,V=0,N=50,T={length:y.end-y.start,start:y.start,end:y.end},S={},z=!0;let P,D,L=[],_=[];var F=[];function I(t,e){S!=={}&&d3.select(S.id).style("fill",S.originalColor),"path"!==e.type&&"line"!==e.type&&(S={id:t,originalColor:d3.select(t).style("fill")||e.color},d3.select(t).style("fill","orangered"))}d3.select(e).style("position","relative").style("padding","0px").style("z-index","2");var R=10,O=20,M=20,q=110,B=$(e).width()-q-O-17,H=600-R-M,G=d3.scale.linear().domain([y.start,y.end]).range([5,B-5]),U=d3.scale.linear().domain([0,B]).range([y.start,y.end]);function W(t,e){for(var n=t-110,a="",i=0;i<e.length;i++)if(G(e[i].x)<n&&G(e[i+1].x)>n){a=n-G(e[i].x)<G(e[i+1].x)-n?e[i]:e[i+1];break}return a}d3.helper={},d3.helper.tooltip=function(t){var a,i,r=d3.select(e).node(),o=n.tooltipColor?n.tooltipColor:"orangered";function l(n){n.on("mouseover.tooltip",(function(n,i){d3.select("body").selectAll("div.tooltip").remove();var l=d3.mouse(r),s=l[0]>B;if(s?a=d3.select(e).append("div").attr("class","tooltip3"):(a=d3.select(e).append("div").attr("class","tooltip2")).style({left:l[0]-15+"px"}),a.style({bottom:r.offsetHeight-l[1]+16+"px","background-color":"#eee",width:"auto","max-width":"170px",height:"auto","max-height":"68px",padding:"5px",font:"10px sans-serif","text-align":"center",position:"absolute","z-index":45,"box-shadow":"0 1px 2px 0 #656565"}),"path"===t.type){var c='<p style="margin:2px;font-weight:700;color:'+o+'">'+n[0].x+"&#x256d;&#x256e;"+n[1].x+"</p>";if(n.description)var p='<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>";else p=""}else if("line"===t.type){var d=W(l[0],n);d.description?(c='<p style="margin:2px;font-weight:700;color:'+o+'">'+d.x+" : <span> "+d.y+"</span></p>",p='<p style="margin:2px;color:'+o+';font-size:9px">'+d.description+"</p>"):(c='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+d.x+"</span></p>",p='<p style="margin:2px;color:'+o+'">count : <span id="tLineC">'+d.y+"</span></p>")}else"bar"===t.type?n.description?c='<p style="margin:2px;font-weight:700;color:'+o+';font-size:9px">'+n.description+"</p>":(c='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+n.x+"</span></p>",p='<p style="margin:2px;color:'+o+'">frequency : <span id="tLineC">'+(n.absoluteY?n.absoluteY:n.y)+"</span></p>"):"unique"===t.type||n.x===n.y?(c='<p style="margin:2px;font-weight:700;color:'+o+'">'+n.x+"</p>",p=n.description?'<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>":""):(c='<p style="margin:2px;font-weight:700;color:'+o+'">'+n.x+" - "+n.y+"</p>",p=n.description?'<p style="margin:2px;color:'+o+';font-size:9px">'+n.description+"</p>":"");p?a.html(c+p):a.html(c),s&&a.style({left:l[0]+10-a.node().getBoundingClientRect().width+"px"})})).on("mousemove.tooltip",(function(e,n){if("line"===t.type){var i=W((c=d3.mouse(r))[0],e);if(i.description)var l='<p style="margin:2px;color:'+o+'">'+i.x+" : <span> "+i.y+"</span></p>",s='<p style="margin:2px;color:'+o+';font-size:9px">'+i.description+"</p>";else l='<p style="margin:2px;color:'+o+'">position : <span id="tLineX">'+i.x+"</span></p>",s='<p style="margin:2px;color:'+o+'">count : <span id="tLineC">'+i.y+"</span></p>";a.html(l+s)}var c;void 0!==a&&((c=d3.mouse(r))[0]>B?(a.attr("class","tooltip3"),a.style({left:c[0]+10-a.node().getBoundingClientRect().width+"px",bottom:r.offsetHeight-c[1]+16+"px"})):(a.attr("class","tooltip2"),a.style({left:c[0]-15+"px",bottom:r.offsetHeight-c[1]+16+"px"})))})).on("mouseout.tooltip",(function(t,e){a.remove()})).on("click",(function(n,a){var o,l,s,d,u;if("text"===this.nodeName){var h="#"+this.previousSibling.id;"#"!==h.nodeName&&I(h,t)}else I(this,t);var f=m.brushActive?d3.select(".background").attr("width"):v.node().getBBox().width;if(d3.select("body").selectAll("div.selectedRect").remove(),i=d3.select(e).append("div").attr("class","selectedRect"),"path"===t.type?(o=n[0].x,l=n[1].x):"line"===t.type?(o=(u=W(d3.mouse(r)[0],n)).x-.5,l=u.x+.5):"unique"===t.type||n.x===n.y?(o=n.x-.4,l=n.y+.4):(o=n.x,l=n.y),G(o)<0&&G(l)>f?(s=q,d=parseInt(f)+5):G(o)<0?(s=q,d=G(l)):G(l)>f?(s=G(o)+q,d=parseInt(f)-G(o),d+=5):(s=G(o)+q,d=G(l)-G(o)),i.style({left:s+"px",top:$(e+" .svgHeader").length?"60px":"10px","background-color":"rgba(0, 0, 0, 0.2)",width:d+"px",height:C+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"}),CustomEvent){var x=new CustomEvent(c.events.FEATURE_SELECTED_EVENT,{detail:{start:"path"===t.type?n[0].x:"line"===t.type?u.x:n.x,end:"path"===t.type?n[1].x:"line"===t.type?u.y:n.y,id:"path"===t.type?n[0].id:"line"===t.type?u.id:n.id,description:"path"===t.type?n[0].description:"line"===t.type?u.description:n.description}});p.dispatchEvent(x)}else console.warn("CustomEvent is not defined....");c.trigger&&c.trigger(c.events.FEATURE_SELECTED_EVENT,{start:"path"===t.type?n[0].x:"line"===t.type?u.x:n.x,end:"path"===t.type?n[1].x:"line"===t.type?u.y:n.y,id:"path"===t.type?n[0].id:"line"===t.type?u.id:n.id,description:"path"===t.type?n[0].description:"line"===t.type?u.description:n.description})}))}return l.attr=function(t){return arguments.length?(attrs=t,this):attrs},l.style=function(t){return arguments.length?(styles=t,this):styles},l};var Z=function(t){return G(t.x)},j=function(t){return B/t>5},X=function(t){return G(t.y)-G(t.x)};function Y(t){return t.x===t.y?G(t.x-.4):G(t.x)}function J(t){return t.x===t.y?G(t.x+.4)-G(t.x-.4)<2?2:G(t.x+.4)-G(t.x-.4):G(t.y)-G(t.x)}function K(t){var e=[];return t.forEach((function(t){if(e===[])e.push(t.y),t.level=0;else{for(var n=!1,a=0;a<e.length;a++)if(t.x>e[a]){n=!0,t.level=a,e[a]=t.y;break}!1===n&&(e.push(t.y),t.level=e.length-1)}})),e.length}this.onFeatureSelected=function(t){p.addEventListener(c.events.FEATURE_SELECTED_EVENT,t)},this.onFeatureDeselected=function(t){p.addEventListener(c.events.FEATURE_DESELECTED_EVENT,t)},this.onZoom=function(t){p.addEventListener(c.events.ZOOM_EVENT,t)},this.onGetPredictions=function(t){p.addEventListener(c.events.GET_PREDICTIONS_EVENT,t)},this.onVariantChanged=function(t){p.addEventListener(c.events.VARIANT_ADDED_EVENT,t)};var Q=d3.svg.line().interpolate("step-before").x((function(t){return G(t.x)})).y((function(t){return 10*-t.y+A})),tt=d3.svg.line().x((function(t){return G(t.x)})).y((function(t){return 10*et(-t.y)+A})),et=d3.scale.linear().domain([0,-30]).range([0,-20]),nt=d3.svg.line().interpolate("linear").x((function(t){return G(t.x)})).y((function(t){return t.y+6})),at=d3.svg.axis().scale(G).tickFormat(d3.format("d")).orient("bottom");function it(t,e,n){if("number"!=typeof t||t<-1||t>1||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||"string"!=typeof n&&void 0!==n)return null;this.sbcRip||(this.sbcRip=function(t){var e=t.length,n=new Object;if(e>9){if((t=t.split(",")).length<3||t.length>4)return null;n[0]=a(t[0].slice(4)),n[1]=a(t[1]),n[2]=a(t[2]),n[3]=t[3]?parseFloat(t[3]):-1}else{if(8==e||6==e||e<4)return null;e<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(e>4?t[4]+""+t[4]:"")),t=a(t.slice(1),16),n[0]=t>>16&255,n[1]=t>>8&255,n[2]=255&t,n[3]=9==e||5==e?i((t>>24&255)/255*1e4)/1e4:-1}return n});var a=parseInt,i=Math.round,r=e.length>9,o=(r="string"==typeof n?n.length>9||"c"==n&&!r:r,t<0),l=(t=o?-1*t:t,n=n&&"c"!=n?n:o?"#000000":"#FFFFFF",sbcRip(e)),s=sbcRip(n);return l&&s?r?"rgb("+i((s[0]-l[0])*t+l[0])+","+i((s[1]-l[1])*t+l[1])+","+i((s[2]-l[2])*t+l[2])+(l[3]<0&&s[3]<0?")":","+(l[3]>-1&&s[3]>-1?i(1e4*((s[3]-l[3])*t+l[3]))/1e4:s[3]<0?l[3]:s[3])+")"):"#"+(4294967296+16777216*(l[3]>-1&&s[3]>-1?i(255*((s[3]-l[3])*t+l[3])):s[3]>-1?i(255*s[3]):l[3]>-1?i(255*l[3]):255)+65536*i((s[0]-l[0])*t+l[0])+256*i((s[1]-l[1])*t+l[1])+i((s[2]-l[2])*t+l[2])).toString(16).slice(l[3]>-1||s[3]>-1?1:3):null}function rt(t){g.attr("height",t+60+"px"),g.select("clippath rect").attr("height",t+60+"px")}var ot=d3.scale.ordinal().domain([0,E.length]).rangeRoundBands([0,500],.1);function lt(){(b=w.selectAll(".yaxis").data(E).enter().append("g")).append("polygon").attr("class",(function(t){return t.filter?t.filter.split(" ").join("_")+"Arrow":"Arrow"})).style("stroke","").style("fill","#DFD5D3").attr("points",(function(t){return q-105+","+(t.y-3)+", "+(q-105)+","+(t.y+12)+", "+(q-15)+","+(t.y+12)+", "+(q-7)+","+(t.y+4.5)+", "+(q-15)+","+(t.y-3)})),b.append("text").attr("class","yaxis").attr("text-anchor","start").attr("x",(function(){return q-102})).attr("y",(function(t){return t.y+8})).text((function(t){return t.title}))}function st(t){t.on("mousedown",(function(){brush_elm=g.select(".brush").node(),new_click_event=new Event("mousedown"),new_click_event.pageX=d3.event.pageX,new_click_event.clientX=d3.event.clientX,new_click_event.pageY=d3.event.pageY,new_click_event.clientY=d3.event.clientY,brush_elm&&brush_elm.dispatchEvent(new_click_event)}))}d3.svg.axis().scale(ot).tickValues(E).tickFormat((function(t){return t})).orient("left");var ct=function(t){t.data.sort((function(t,e){return t.x-e.x}));var e=K(t.data);t.data=t.data.map((function(t){return[{x:t.x,y:0,id:t.id,description:t.description,color:t.color},{x:t.y,y:t.level+1,id:t.id},{x:t.y,y:0,id:t.id}]})),A=10*e+5,t.height=10*e+5},pt=function(t){t.height||(t.height=10);var e=parseInt(t.height),n=0;for(var a in t.data){t.data[a].sort((function(t,e){return t.x-e.x})),0!==t.data[a][0].y&&t.data[a].unshift({x:t.data[a][0].x-1,y:0}),0!==t.data[a][t.data[a].length-1].y&&t.data[a].push({x:t.data[a][t.data[a].length-1].x+1,y:0});var i=Math.max.apply(Math,t.data[a].map((function(t){return Math.abs(t.y)})));n=i>n?i:n,t.data[a]=[t.data[a].map((function(t){return{x:t.x,y:t.y,id:t.id,description:t.description}}))]}et.range([0,-e]).domain([0,-n]),A=10*e+5,t.level=n,t.shift=10*e+5},dt=function(t){t.height||(t.height=10);var e=parseInt(t.height),n=0;for(var a in t.data){t.data[a].sort((function(t,e){return t.x-e.x})),0!==t.data[a][0].y&&t.data[a].unshift({x:t.data[a][0].x-1,y:0}),0!==t.data[a][t.data[a].length-1].y&&t.data[a].push({x:t.data[a][t.data[a].length-1].x+1,y:0});var i=Math.max.apply(Math,t.data[a].map((function(t){return Math.abs(t.y)})));n=i>n?i:n}et.range([0,-e]).domain([0,-n]),A=10*e+5,t.maxValue=i,t.level=n,t.shift=10*e+5},ut=function(t){t.data.sort((function(t,e){return t.x-e.x})),t.highlight&&Array.isArray(t.highlight)&&t.highlight.forEach((function(e){for(var n in t.data)e.x==t.data[n].x&&e.y==t.data[n].y&&(t.data[n].highlight=!0,t.data[n].color=e.color,t.data[n].description=e.highlightText)})),k=K(t.data),A=10*k+5},ht={typeIdentifier:function(t,e){if("rect"===t.type)ut(t),E.push({title:t.name,y:C,filter:t.filter}),ht.rectangle(t,C,e);else if("text"===t.type)ht.sequence(t.data,C),E.push({title:t.name,y:C,filter:t.filter}),G.range([5,B-5]);else if("unique"===t.type)ht.unique(t,C),E.push({title:t.name,y:C,filter:t.filter});else if("multipleRect"===t.type)ut(t),ht.multipleRect(t,C,k),E.push({title:t.name,y:C,filter:t.filter}),C+=10*(k-1);else if("path"===t.type)ct(t),ht.path(t,C),C+=A,E.push({title:t.name,y:C-10,filter:t.filter});else if("line"===t.type){Array.isArray(t.data[0])||(t.data=[t.data]),Array.isArray(t.color)||(t.color=[t.color]);var n=!1;t.data.forEach((function(t){t.filter((function(t){return t.y<0})).length&&(n=!0)})),pt(t),ht.line(t,C),C+=A,E.push({title:t.name,y:C-10,filter:t.filter}),C+=n?A-5:0}else"bar"===t.type&&(Array.isArray(t.data[0])||(t.data=[t.data]),Array.isArray(t.color)||(t.color=[t.color]),n=!1,t.data.forEach((function(t){t.filter((function(t){return t.y<0})).length&&(n=!0)})),dt(t),ht.bar(t,C,e),C+=A,E.push({title:t.name,y:C-10,filter:t.filter}),C+=n?A-5:0)},sequence:function(t,n,r){let c;r||(r=0),v.append("g").attr("class","seqGroup").selectAll(".AA").data(t).enter().append("text",(function(){return d+"-"+i})).attr("clip-path","url(#clip)").attr("class","AA").attr("text-anchor","middle").attr("x",(function(t,e){return G.range([5,B-5])(e+r)})).attr("y",n).attr("font-size","10px").attr("font-family","monospace").text((function(t,e){return t})).on("click",(function(t){c=t;const e=function(t,e){const n=800;return t-e<n?t-(n/2+(t-e)):e}($(window).width(),this.getBoundingClientRect().x);y(!0,e)}));let p=($(e+" .svgHeader").length?d3.select(e+" .svgHeader"):d3.select(e).append("div").attr("class","svgHeader")).append("div").attr("class","single-variant-popup");p.append("svg").attr("class","cancel-icon").attr("height","1.5rem").attr("width","1.5rem").attr("viewBox","0 0 512 640").on("click",(function(){y(!1),$("#single-dropdown-content").hide()})).html(a);let u=p.append("div");u.html('\n                        <p>Enter the variants</p>\n                        <div class="properties-row">\n                            <p class="title">Position</p>\n                            <div class="single-variant-nextprotPosition"></div>\n                        </div>\n                        <div class="properties-row">\n                            <p class="title">Original</p>\n                            <div class="single-variant-original"></div>\n                        </div>\n                    ');const h=u.append("div").attr("class","properties-row");h.append("p").attr("class","title").text("Variant");let f=h.append("div").attr("class","dropdown").on("click",(function(){$("#single-dropdown-content").show()}));f.append("button").attr("class","dropdown-btn").attr("id","single-variant-dropdown-btn").text("Select variant"),f.append("div").attr("class","bottom-arrow-icon").html(o);const x=f.append("div").attr("id",(function(){return"single-dropdown-content"}));u.append("button").attr("disabled",!0).attr("class","single-add-variant-btn").text("Add Variant").on("click",(function(){!function(t){if(""===t)return void console.log("Variant not added");let e=t.split(" /")[0],n={},a=$(".single-variant-nextprotPosition").text();n.nextprotPosition=Number(a),n.originalAminoAcid=c,n.variantAminoAcid=e,L.push(n),s(!0,"success","#single-variant-toast"),Tt()}($("#single-variant-dropdown-btn").text())})),u.append("div").attr("class","toast").attr("id","single-variant-toast"),x.append("input").attr("placeholder","Search...").attr("id","dropdown-search-input").on("keyup",(function(){let t,e,n,a,i,r;for(t=document.getElementById("dropdown-search-input"),e=t.value.toUpperCase(),i=document.getElementById("dropdown-options"),n=i.getElementsByTagName("p"),a=0;a<n.length;a++)r=n[a].textContent||n[a].innerText,r.toUpperCase().indexOf(e)>-1?n[a].style.display="":n[a].style.display="none"}));let m=x.append("div").attr("class","dropdown-option-container").attr("id","dropdown-options");function y(t,e){variantValue="",s(!1,"error","#single-variant-error"),$("#single-variant-dropdown-btn").text("Select variant"),$("#single-variant-error").text(""),$(".single-add-variant-btn").attr("disabled",!0),$(".single-variant-nextprotPosition").text((function(){return D})),$(".single-variant-original").text((function(){return`${c} / ${l[c]}`})),p.style("left",`${e}px`).style("display",t?"block":"none")}Object.entries(l).forEach((([t,e])=>{m.append("p").attr("class","single-dropdown-options").attr("id",`${t} / ${e}`).text(`${t} / ${e}`)})),$(document).on("click",".single-dropdown-options",(function(){const t=$(this).attr("id");$("#single-dropdown-content").hide();let e=t.split(" /")[0];if(c===e)return s(!0,"error","#single-variant-toast"),$(".single-add-variant-btn").attr("disabled",!0),void $("#single-variant-dropdown-btn").text("Select variant");s(!1,"error","#single-variant-toast"),variantValue=t,$(this).parent().parent().parent().children("button").text((function(){return t})),$(".single-add-variant-btn").attr("disabled",!1)}))},sequenceLine:function(){m.dottedSequence&&v.selectAll(".sequenceLine").data([[{x:1,y:12},{x:f,y:12}]]).enter().append("path").attr("clip-path","url(#clip)").attr("d",nt).attr("class","sequenceLine").style("z-index","0").style("stroke","black").style("stroke-dasharray","1,3").style("stroke-width","1px").style("stroke-opacity",0).transition().duration(500).style("stroke-opacity",1)},rectangle:function(t,e,n){t.height||(t.height=12),t.showDescriptionRect||(t.showDescriptionRect=!0),t.summaryView||(t.summaryView=!1),t.summaryViewProperties||(t.summaryViewProperties={}),t.summaryViewProperties.buttonColor||(t.summaryViewProperties.buttonColor="#5789d4"),t.summaryViewProperties.buttonTextColor||(t.summaryViewProperties.buttonTextColor="#ffffff"),t.summaryViewProperties.buttonLabel||(t.summaryViewProperties.buttonLabel="Click Here to Load All Data"),t.summaryViewProperties.position||(t.summaryViewProperties.position="left");var a=0;a="left"===t.summaryViewProperties.position?2:"right"===t.summaryViewProperties.position?f/8*6.6-2:"center"===t.summaryViewProperties.position?f/8*3.5-2:2;for(var i=t.height,r=i+i/3,o=i/2-6,l=v.append("g").attr("class","rectangle").attr("clip-path","url(#clip)").attr("transform","translate(0,"+e+")"),s=[],c=0;c<k;c++)s.push([{x:1,y:c*r+o},{x:f,y:c*r+o}]);if(l.selectAll(".line"+t.className).data(s).enter().append("path").attr("d",nt).attr("class",(function(){return"line"+t.className})).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),t.summaryView)l.selectAll("rectbox").data([10]).enter().append("rect").attr("width",f/8).attr("height",15).attr("x",a).attr("y",o-10).attr("fill",t.summaryViewProperties.buttonColor).on("click",n),l.append("text").attr("x",a+f/80).attr("y",o+1).attr("font-size","10px").attr("fill",t.summaryViewProperties.buttonTextColor).text(t.summaryViewProperties.buttonLabel).on("click",n);else{var p=l.selectAll("."+t.className+"Group").data(t.data).enter().append("g").attr("class",t.className+"Group").attr("transform",(function(t){return"translate("+Y(t)+",0)"}));p.append("rect").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("y",(function(t){return t.level*r})).attr("width",J).attr("height",i).style("fill",(function(e){return e.color||t.color})).style("z-index","13").call(d3.helper.tooltip(t)),t.showDescriptionRect&&p.append("text").attr("class","element "+t.className+"Text").attr("y",(function(t){return t.level*r+i/2})).attr("dy","0.35em").style("font-size","10px").text((function(t){return t.description})).style("fill","black").style("z-index","15").style("visibility",(function(t){return t.description&&G(t.y)-G(t.x)>8*t.description.length&&i>11?"visible":"hidden"})).call(d3.helper.tooltip(t)),st(p);var d=i>12?i-6:0;C+=k<2?d:(k-1)*r+d}},unique:function(t,e){var n=v.append("g").attr("class","uniquePosition").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:f,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",nt).attr("class","line"+t.className).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),n.selectAll("."+t.className).data(t.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("x",(function(t){return G(t.x-.4)})).attr("width",(function(t){return G(t.x+.4)-G(t.x-.4)<2?2:G(t.x+.4)-G(t.x-.4)})).attr("height",12).style("fill",(function(e){return e.color||t.color})).style("z-index","3").call(d3.helper.tooltip(t)),st(n)},path:function(t,e){var n=v.append("g").attr("class","pathing").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:f,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",Q).attr("class","line"+t.className).style("z-index","0").style("stroke",t.color).style("stroke-width","1px"),n.selectAll("."+t.className).data(t.data).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t[0].id})).attr("d",Q).style("fill","none").style("stroke",(function(e){return e[0].color||t.color})).style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(t)),st(n)},line:function(t,e){t.interpolation||(t.interpolation="monotone"),void 0===t.fill&&(t.fill=!0);var n=v.append("g").attr("class","lining").attr("transform","translate(0,"+e+")"),a=[];a.push([{x:1,y:0},{x:f,y:0}]),n.selectAll(".line"+t.className).data(a).enter().append("path").attr("clip-path","url(#clip)").attr("d",Q).attr("class","line"+t.className).style("z-index","0").style("stroke","black").style("stroke-width","1px"),t.data.forEach((function(e,a,i){n.selectAll("."+t.className+a).data(e).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+t.className+" "+t.className+a).attr("d",tt.interpolate(t.interpolation)).style("fill",t.fill?it(.6,t.color[a])||it(.6,"#000"):"none").style("stroke",t.color[a]||"#000").style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(t))})),st(n)},bar:function(t,e,n){void 0===t.fill&&(t.fill=!0),t.summaryView||(t.summaryView=!1),t.summaryViewProperties||(t.summaryViewProperties={}),t.summaryViewProperties.buttonColor||(t.summaryViewProperties.buttonColor="#5789d4"),t.summaryViewProperties.buttonTextColor||(t.summaryViewProperties.buttonTextColor="#ffffff"),t.summaryViewProperties.buttonLabel||(t.summaryViewProperties.buttonLabel="Click Here to Load All Data"),t.summaryViewProperties.position||(t.summaryViewProperties.position="left");var a=0;a="left"===t.summaryViewProperties.position?2:"right"===t.summaryViewProperties.position?f/6*4.7-2:"center"===t.summaryViewProperties.position?f/6*2.5:2;var i=v.append("g").attr("class","bar").attr("clip-path","url(#clip)").attr("transform","translate(0,"+e+")"),r=[];r.push([{x:1,y:0},{x:f,y:0}]);var o=d3.scale.linear().domain([0,t.maxValue]).range([0,t.shift]);i.selectAll(".line"+t.className).data(r).enter().append("path").attr("clip-path","url(#clip)").attr("d",tt).attr("class","line"+t.className).style("z-index","0").style("stroke","black").style("stroke-width","1px"),t.summaryView?(i.selectAll("rectbox").data([10]).enter().append("rect").attr("width",f/6).attr("height",25).attr("x",a).attr("y",t.shift-25).attr("fill",t.summaryViewProperties.buttonColor).on("click",n),i.append("text").attr("x",a+f/60).attr("y",t.shift-12).attr("dy",".35em").attr("fill",t.summaryViewProperties.buttonTextColor).text(t.summaryViewProperties.buttonLabel).on("click",n)):t.data.forEach((function(e,n,a){i.selectAll().data(e).enter().append("rect").attr("class","element "+t.className).attr("x",(function(t){return G(t.x-.4)})).attr("width",(function(t){return G(t.x+.4)-G(t.x-.4)<2?2:G(t.x+.4)-G(t.x-.4)})).attr("y",(function(e){return t.shift-o(e.y)})).attr("height",(function(t){return o(t.y)})).style("fill",(function(e){return e.color||t.color})).style("z-index","3").call(d3.helper.tooltip(t))})),st(i)},multipleRect:function(t,e,n){for(var a=v.append("g").attr("class","multipleRects").attr("transform","translate(0,"+e+")"),i=0;i<n;i++)a.append("path").attr("d",nt([{x:1,y:10*i-2},{x:f,y:10*i-2}])).attr("class",(function(){return"line"+t.className})).style("z-index","0").style("stroke",t.color).style("stroke-width","1px");a.selectAll("."+t.className).data(t.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+t.className).attr("id",(function(t){return"f"+t.id})).attr("x",Z).attr("y",(function(t){return 10*t.level})).attr("width",X).attr("height",8).style("fill",(function(e){return e.color||t.color})).style("z-index","13").call(d3.helper.tooltip(t)),st(a)}};this.showFilteredFeature=function(t,e,n){w.selectAll("."+t+"Arrow");var a=q-105,i=q-7,r=g.append("linearGradient").attr("y1","0").attr("y2","0").attr("x1",a).attr("x2",i).attr("id","gradient").attr("spreadMethod","pad").attr("gradientUnits","userSpaceOnUse");r.append("stop").attr("offset","0.3").attr("stop-color","#DFD5D3").attr("stop-opacity",1),r.append("stop").attr("offset","1").attr("stop-opacity",1).attr("stop-color","#DFD5D3").attr("stop-color",e);var o="url(#gradient)",l="url(#dropshadow)";n&&(o="url("+n+"#gradient)",l="url("+n+"#dropshadow)"),w.selectAll("."+t+"Arrow").style("fill",o).style("stroke","").attr("filter",l).attr("points",(function(t){return q-105+","+(t.y-3)+", "+(q-105)+","+(t.y+12)+", "+(q-10)+","+(t.y+12)+", "+(q-2)+","+(t.y+4.5)+", "+(q-10)+","+(t.y-3)}))},this.hideFilteredFeature=function(t){w.selectAll("."+t+"Arrow").style("fill","rgba(95,46,38,0.2)").attr("filter","").attr("points",(function(t){return q-105+","+(t.y-3)+", "+(q-105)+","+(t.y+12)+", "+(q-15)+","+(t.y+12)+", "+(q-7)+","+(t.y+4.5)+", "+(q-15)+","+(t.y-3)}))};var ft=function(t){v.selectAll(".line"+t.className).attr("d",nt.x((function(t){return G(t.x)}))),z?(transit1=v.selectAll("."+t.className+"Group").transition().duration(500),transit2=v.selectAll("."+t.className).transition().duration(500)):(transit1=v.selectAll("."+t.className+"Group"),transit2=v.selectAll("."+t.className)),transit1.attr("transform",(function(t){return"translate("+Y(t)+",0)"})),transit2.attr("width",J),v.selectAll("."+t.className+"Text").style("visibility",(function(e){return e.description&&G(e.y)-G(e.x)>8*e.description.length&&t.height>11?"visible":"hidden"}))},xt=function(t){v.selectAll("."+t.className).attr("x",(function(t){return G(t.x)})).attr("width",(function(t){return G(t.y)-G(t.x)}))},mt=function(t){v.selectAll(".line"+t.className).attr("d",nt.x((function(t){return G(t.x)}))),(z?v.selectAll("."+t.className).transition().duration(500):v.selectAll("."+t.className)).attr("x",(function(t){return G(t.x-.4)})).attr("width",(function(t){return G(t.x+.4)-G(t.x-.4)<2?2:G(t.x+.4)-G(t.x-.4)}))},yt=function(t){v.selectAll(".line"+t.className).attr("d",Q.x((function(t){return G(t.x)})).y((function(e){return 10*-e.y+t.height}))),(z?v.selectAll("."+t.className).transition().duration(500):v.selectAll("."+t.className)).attr("d",Q.y((function(e){return 10*-e.y+t.height})))},gt=function(t){et.range([0,-t.height]).domain([0,-t.level]),v.selectAll(".line"+t.className).attr("d",tt.y((function(e){return 10*et(-e.y)+t.shift}))),(z?v.selectAll("."+t.className).transition().duration(500):v.selectAll("."+t.className)).attr("d",tt.y((function(e){return 10*et(-e.y)+t.shift})).interpolate(t.interpolation))},vt=function(t){(z?v.selectAll("."+t.className).transition().duration(500):v.selectAll("."+t.className)).attr("x",(function(t){return G(t.x-.4)})).attr("width",(function(t){return G(t.x+.4)-G(t.x-.4)<2?2:G(t.x+.4)-G(t.x-.4)}))},wt=function(t,e){(z?v.selectAll("."+t.className).transition().duration(500):v.selectAll("."+t.className)).attr("x",(function(t,n){return G(n+e)}))},bt=d3.svg.brush().x(G).on("brushend",At);function At(){if(d3.select(e).selectAll("div.selectedRect").remove(),0!==Object.keys(S).length&&S.constructor===Object){if(d3.select(S.id).style("fill",S.originalColor),S={},CustomEvent){var n=new CustomEvent(c.events.FEATURE_DESELECTED_EVENT,{detail:{info:"feature-deselected"}});p.dispatchEvent(n)}else console.warn("CustomEvent is not defined....");c.trigger&&c.trigger(c.events.FEATURE_DESELECTED_EVENT,{info:"feature-deselected"})}var a=bt.extent(),i=Math.abs(a[0]-a[1]);if(a[0]<a[1])var r=parseInt(a[0]-1),o=parseInt(a[1]+1);else r=parseInt(a[1]+1),o=parseInt(a[0]-1);var l=j(i);if(!bt.empty()&&i>N){T.length=i;var s=(f/i).toFixed(1);$(e+" .zoomUnit").text(s.toString()),m.showSequence&&!h&&l&&v.selectAll(".AA").empty()&&(T={length:i,start:r,end:o},V=r,v.selectAll(".sequenceLine").remove(),ht.sequence(t.substring(r-1,o),20,V-1)),G.domain(a),U.range(a);var d=V||y.start;kt(x,d),Vt(),CustomEvent&&p.dispatchEvent(new CustomEvent(c.events.ZOOM_EVENT,{detail:{start:r,end:o,zoom:s}})),c.trigger&&c.trigger(c.events.ZOOM_EVENT,{start:r,end:o,zoom:s}),d3.select(e).selectAll(".brush").call(bt.clear())}else d3.select(e).selectAll(".brush").call(bt.clear())}this.zoom=function(t,e){T.start<t&&T.end>e||v.selectAll(".seqGroup").remove(),bt.extent([t,e]),At()},this.resetZoom=function(t,e){Ct()};var Et=function(){!function(){B=$(e).width()-q-O-17,d3.select(e+" svg").attr("width",B+q+O),d3.select(e+" #clip>rect").attr("width",B),m.brushActive&&d3.select(e+" .background").attr("width",B),d3.select(e).selectAll(".brush").call(bt.clear());var n=j(T.length);m.showSequence&&!h&&(!1!==n||v.selectAll(".AA").empty()?!0===n&&v.selectAll(".AA").empty()&&(v.selectAll(".sequenceLine").remove(),ht.sequence(t.substring(T.start-1,T.end),20,T.start-1)):(v.selectAll(".seqGroup").remove(),ht.sequenceLine())),G.range([5,B-5]),U.domain([0,B]),kt(x,T.start),Vt()}()};function Ct(){$(".zoomUnit").text("1"),G.domain([y.start,y.end]),U.range([y.start,y.end]);var n=j(y.end-y.start);m.showSequence&&!h&&(!1!==n||v.selectAll(".AA").empty()?T.length===f||!0!==n||v.selectAll(".AA").empty()||(v.selectAll(".seqGroup").remove(),ht.sequence(t.substring(y.start-1,y.end),20,y.start)):(v.selectAll(".seqGroup").remove(),ht.sequenceLine())),T={length:y.end-y.start,start:y.start,end:y.end},V=0,kt(x,y.start),Vt(),CustomEvent&&p.dispatchEvent(new CustomEvent(c.events.ZOOM_EVENT,{detail:{start:1,end:t.length,zoom:1}})),c.trigger&&c.trigger(c.events.ZOOM_EVENT,{start:1,end:t.length,zoom:1}),d3.select(e).selectAll(".brush").call(bt.clear())}function kt(t,e){t.forEach((function(t){"rect"===t.type?ft(t):"multipleRect"===t.type?xt(t):"unique"===t.type?mt(t):"path"===t.type?yt(t):"line"===t.type?gt(t):"text"===t.type?wt(t,e):"bar"===t.type&&vt(t,e)}))}function Vt(){v.transition().duration(500).select(".x.axis").call(at)}function Nt(e,n){if(void 0===n&&(n={showAxis:!1,showSequence:!1,brushActive:!1,verticalLine:!1,toolbar:!1,bubbleHelp:!1,buttonDownload:!0,showvariant:!1,unit:"units",zoomMax:50}),$.fn.popover||(n.bubbleHelp=!1,console.warn("The bubble help requires tooltip and popover bootstrap js libraries. The feature viewer will continue to work, but without the info bubble")),n.zoomMax&&(N=n.zoomMax),n.unit||(n.unit="units"),n.animation&&(z=n.animation),!0===n.toolbar){var i=$(e+" .svgHeader").length?d3.select(e+" .svgHeader"):d3.select(e).append("div").attr("class","svgHeader");if(!$(e+" .header-position").length){var d=i.append("div").attr("class","header-position").style("display","inline-block").style("margin","15px 10px 0px").style("padding","0px").style("line-height","32px");d.append("div").attr("class","position-label").style("padding","0px 5px").style("display","inline-block").style("padding","0px").style("font-weight","700").text("Position  :  "),d.append("div").style("display","inline-block").style("padding","0px").style("padding-left","5px").append("div").style("min-width","50px").attr("id","zoomPosition").text("0")}$(e+" .header-zoom").length||((f=i.append("div").attr("class","header-zoom").style("display","inline-block").style("margin","15px 0px 0px").style("padding","0px").style("line-height","32px")).append("div").attr("class","zoom-label").style("padding","0px 5px").style("display","inline-block").style("padding","0px").style("font-weight","700").text("Zoom : "),f.append("div").style("display","inline-block").style("padding","0px").append("div").style("min-width","50px").style("padding-left","5px").append("span").text("x ").append("span").attr("class","zoomUnit").text("1"));var f=$(e+" .header-zoom").length?d3.select(e+" .header-zoom"):i;if(!0===n.bubbleHelp&&!$(e+" .header-help").length){var b="<div><strong>To zoom in :</strong> Left click to select area of interest</div><div><strong>To zoom out :</strong> Right click to reset the scale</div><div><strong>Zoom max  :</strong> Limited to <strong>"+N.toString()+" "+n.unit+"</strong></div>";f.append("div").style("display","inline-block").style("margin","0px").style("margin-right","5px").style("padding","0px").append("a").attr("type","button").attr("class","header-help").attr("data-toggle","popover").attr("data-placement","auto left").attr("title","Help").attr("data-content",b).style("font-size","14px").append("span").attr("class","label label-as-badge label-info").style("font-weight","500").style("border-radius","3px").style("box-shadow","inset 0px 0px 4px rgba(0,0,0,0.10)").style("color","#fff").html("<span class='state'>Show</span> help"),$((function(){$('[data-toggle="popover"]').popover({html:!0}),$(e+" .header-help").on("hide.bs.popover",(function(){$(this).find(".state").text("Show")})),$(e+" .header-help").on("show.bs.popover",(function(){$(this).find(".state").text("Hide")}))}))}!0===n.buttonDownload&&($(e+" .header-svg").length||(f.append("div").attr("id","download").style("display","inline-block").style("margin","0px").style("margin-right","5px").style("padding","0px").attr("width","30px").append("a").attr("type","button").attr("class","header-svg").attr("data-toggle","popover").attr("data-placement","auto left").attr("title","SVG").attr("data-content","").style("font-size","14px").append("span").attr("class","label label-as-badge label-info").style("font-weight","500").style("border-radius","3px").style("box-shadow","inset 0px 0px 4px rgba(0,0,0,0.10)").style("color","#fff").html("<span class='state'>SVG</span>"),$((function(){$("#download").click((function(){St()}))}))))}if(!$(e+" .variantHeader").length){const Z=($(e+" .svgHeader").length?d3.select(e+" .svgHeader"):d3.select(e).append("div").attr("class","svgHeader")).append("div").style("position","relative").style("display","flex").style("column-gap","1rem");let X=!0,Y=0;Z.append("span").attr("class","add-variant-btn").style("margin-left","auto").text("+ Add Variants").on("click",(function(){S(X),0===_.length&&k(),X=!X}));const J=Z.append("div").attr("class","multiple-variant-popup");J.html(`<p>Enter the variants</p><div class="header"><input type="checkbox" id="select-all-variant" />${r}<p>Position</p><p>Original</p><p>Variant</p></div>`),$(".delete-icon").on("click",(function(){if($(".input-wrapper input:checkbox").each((function(){var t=$(this);if(t.is(":checked")){let e=$(this).attr("id");t.parent().remove();const n=_.findIndex((t=>t.id==e));_.splice(n,1),Tt()}})),0===_.length){Y=0,T(!1),_=[],Tt();const t={id:Y,nextprotPosition:"",originalAminoAcid:"",variantAminoAcid:""};_.push(t),k()}})),$("#select-all-variant").on("click",(function(){$(".input-wrapper input:checkbox").prop("checked",this.checked)})),J.append("svg").attr("height","1.5rem").attr("width","1.5rem").attr("class","cancel-icon").on("click",(function(){X=!X,S(!1)})).attr("viewBox","0 0 500 620").html(a);const K=J.append("div").attr("class","input-container");function A(e,n,a){const i=_.findIndex((t=>t.id==a));switch(e=e.split(" /")[0],n){case"nextprotPosition":const n=t.charAt(Number(e)-1);$(`#${a}-original`).text((function(){return`${n} / ${l[n]}`})),$(`#${a}-nextprotPosition`).val(e),_[i].originalAminoAcid=n,_[i].nextprotPosition=Number(e),V(n,_[i].variantAminoAcid)||(_[i].variantAminoAcid="",$(`#${a}-variant`).text("Select variant"));break;case"variantAminoAcid":if(!V(_[i].originalAminoAcid,e))break;_[i].variantAminoAcid=e}}function k(){$("#multiple-add-variant-btn").attr("disabled",!0),_.length>0&&s(!0,"success","#multiple-variant-toast");const e={id:Y,nextprotPosition:"",originalAminoAcid:"",variantAminoAcid:""};_.push(e);const n=K.append("div").attr("class","input-wrapper");n.append("input").attr("type","checkbox").attr("class","input-checkbox").attr("id",(function(){return Y})),n.append("input").attr("class","popup-input").attr("maxlength","5").attr("id",(function(){return Y+"-nextprotPosition"})).attr("type","number").attr("value",(function(t,e){return e})).on("change",(function(e){var n=d3.select(this).property("value");n>t.length&&(n=t.length),n<2&&(n="2"),d3.select(this).attr("value",n),d3.select(this)[0][0].setAttribute("value",n),A(n,"nextprotPosition",d3.select(this).property("id").split("-")[0])})),n.append("span").attr("id",(function(){return Y+"-original"})).attr("class","original-input").text("0");const a=n.append("div").attr("class","dropdown");a.append("button").attr("class","dropdown-btn").attr("id",(function(){return Y+"-variant"})).text("Select variant").on("click",(function(){let t=$(this).attr("id");$("div.dropdown-content").not(`#${t}-dropdown`).hide(),$(`#${t}-dropdown`).toggle()})),a.append("div").attr("class","bottom-arrow-icon").html(o);const i=a.append("div").attr("id",(function(){return Y+"-variant-dropdown"})).attr("class","dropdown-content");i.append("input").attr("placeholder","Search...").attr("id",`dropdown-search-input-${Y}`).attr("class","dropdown-input").on("keyup",(function(){let t,e,n,a,i=this.id.split("-")[3];for(t=this.value.toUpperCase(),a=document.getElementById(`dropdown-options-${i}`),e=a.getElementsByTagName("p"),n=0;n<e.length;n++)txtValue=e[n].textContent||e[n].innerText,txtValue.toUpperCase().indexOf(t)>-1?e[n].style.display="":e[n].style.display="none"}));let r=i.append("div").attr("class","dropdown-option-container").attr("id",`dropdown-options-${Y}`);Object.entries(l).forEach((([t,e])=>{r.append("p").attr("class","dropdown-options").attr("id",`${t} / ${e}`).text(`${t} / ${e}`)})),Y++}function V(t,e){if(t===e)return T(!0),$("#multiple-add-variant-btn").attr("disabled",!0),!1;T(!1);const n=$(".input-container").children(":last").children(":last").children(":first").text(),a=$(".input-container").children(":last").children(".popup-input").attr("value");return""!=n&&"Select variant"!=n&&0!=a&&$("#multiple-add-variant-btn").attr("disabled",!1),!0}function T(t){s(t,"error","#multiple-variant-toast")}$(document).on("click",".dropdown-options",(function(){const t=$(this).attr("id");$(".dropdown-content").hide();const e=$(this).parent().parent().attr("id").split("-")[0];$(this).parent().parent().parent().children("button").text((function(){return t})),A(t,"variantAminoAcid",e)}));const Q=J.append("div").attr("class","multiple-variant-btn-container");function S(t){J.style("display",t?"block":"none")}Q.append("button").attr("class","add-variant-btn").attr("id","multiple-add-variant-btn").attr("disabled",!0).text("+").on("click",(function(){Tt(),k()})),Q.append("span").text("Get Predictions").attr("class","get-predictions-btn").on("click",(function(){!function(){const t=$t();CustomEvent&&p.dispatchEvent(new CustomEvent(c.events.GET_PREDICTIONS_EVENT,{detail:t})),c.trigger&&c.trigger(c.events.GET_PREDICTIONS_EVENT,t)}()})),J.append("div").attr("class","toast").attr("id","multiple-variant-toast")}g=d3.select(e).append("svg").attr("width",B+q+O).attr("height",H+R+M).style("z-index","2").on("contextmenu",(function(t,e){d3.event.preventDefault(),Ct()})),p=u.getElementsByTagName("svg")[0];var L=(v=g.append("g").attr("id","svg-container").attr("transform","translate("+q+","+R+")")).append("defs");L.append("clipPath").attr("id","clip").append("rect").attr("width",B).attr("height",H);var F=L.append("filter").attr("id","dropshadow").attr("height","200%");F.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",3).attr("result","blur"),F.append("feOffset").attr("in","blur").attr("dx",-2).attr("dy",2).attr("result","offsetBlur");var I,G,W=F.append("feMerge");W.append("feMergeNode").attr("in","offsetBlur"),W.append("feMergeNode").attr("in","SourceGraphic"),v.on("mousemove",(function(){let a=m.brushActive?d3.mouse(d3.select(".background").node()):d3.mouse(v.node());P=Math.round(U(a[0])),D=P,n.positionWithoutLetter||(P+=t[P-1]||""),$(e+" #zoomPosition").text(P)})),void 0!==n.dottedSequence&&(m.dottedSequence=n.dottedSequence),n.showSequence&&!h&&(m.showSequence=!0,j(y.end-y.start)?ht.sequence(t.substring(y.start-1,y.end),C,y.start):ht.sequenceLine(),x.push({data:t,name:"Sequence",className:"AA",color:"black",type:"text"}),E.push({title:"Sequence",y:C-8})),n.showAxis&&(I=C,v.append("g").attr("class","x axis Xaxis").attr("transform","translate(0,"+(I+20)+")").call(at)),w=g.append("g").attr("class","pro axis").attr("transform","translate(0,"+R+")"),lt(),n.brushActive&&(m.brushActive=!0,v.append("g").attr("class","brush").call(bt).selectAll("rect").attr("height",C+50)),n.verticalLine&&(m.verticalLine=!0,G=d3.select(".chart").append("div").attr("class","Vline").style("position","absolute").style("z-index","19").style("width","1px").style("height",C+50+"px").style("top","30px").style("background","#000"),d3.select(".chart").on("mousemove.Vline",(function(){mousex=d3.mouse(this)[0]-2,G.style("left",mousex+"px")}))),rt(C)}function Tt(){let t=[..._];if(t.length>0){const e=t.length-1;""!=t[e].originalAminoAcid&&""!=t[e].variantAminoAcid||t.splice(e,1)}t=[...t,...L],CustomEvent&&p.dispatchEvent(new CustomEvent(c.events.VARIANT_ADDED_EVENT,{detail:t})),c.trigger&&c.trigger(c.events.VARIANT_ADDED_EVENT,t)}function $t(){let t=_.map((({id:t,...e})=>({...e})));if(t.length>0){const e=t.length-1;""!=t[e].originalAminoAcid&&""!=t[e].variantAminoAcid||t.splice(e,1)}return t=[...t,...L],t}$(window).on("resize",Et),this.addRectSelection=function(t){var n,a,i,r,o=d3.select(t),l=o.data(),s=m.brushActive?d3.select(".background").attr("width"):v.node().getBBox().width;d3.select("body").selectAll("div.selectedRect").remove(),I(t,{type:o[0][0].tagName,color:o.style("fill")});var c=d3.select(e).append("div").attr("class","selectedRect");3===l[0].length?(n=l[0][0].x,a=l[0][1].x):l[0].x===l[0].y?(n=l[0].x-.5,a=l[0].y+.5):(n=l[0].x,a=l[0].y),G(n)<0?(i=q,r=G(a)):G(a)>s?(i=G(n)+q,r=s-G(n)):(i=G(n)+q,r=G(a)-G(n)),c.style({left:i+"px",top:"60px","background-color":"rgba(0, 0, 0, 0.2)",width:r+"px",height:C+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"})},Nt(e,n),$(".seqGroup").appendTo($("#svg-container")),this.getPredictions=function(){return $t()},this.addFeature=function(t,e){!t.summaryView||void 0!==t.data&&0!==t.data.length||(t.data=[{x:10,y:15}]);const n=JSON.parse(JSON.stringify(t));var a;F.push(n),C+=20,x.push(t),ht.typeIdentifier(t,e),lt(),a=C,v.selectAll(".Xaxis").attr("transform","translate(0,"+(a+20)+")"),rt(C),m.brushActive&&v.selectAll(".brush rect").attr("height",C+50),m.verticalLine&&d3.selectAll(".Vline").style("height",C+50+"px"),d3.selectAll(".element")[0].length>1500&&(z=!1)},this.loadSummaryFeature=function(t){var a=F;F=[];var i=e;e.includes("#")&&(i=e.split("#")[1]);var r=document.getElementById(i),o=r.getElementsByTagName("svg");r.removeChild(o[0]),C=20,E=[],x=[],d3.select(e).style("position","relative").style("padding","0px").style("z-index","2"),Nt(e,n),a.forEach((function(e){e.className==t.className&&(e.summaryView=!1,e.data=t.data),this.addFeature(e)}))},this.clearInstance=function(){$(window).off("resize",Et),g=null,p=null,v=null,b=null,w=null,x=null,sbcRip=null,d3.helper={}};const St=function(){var t=e;e.includes("#")&&(t=e.split("#")[1]);var n=document.getElementById(t).getElementsByTagName("svg")[0],a=(new XMLSerializer).serializeToString(n);a.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)||(a=a.replace(/^<svg/,'<svg xmlns="http://www.w3.org/2000/svg"')),a.match(/^<svg[^>]+"http\:\/\/www\.w3\.org\/1999\/xlink"/)||(a=a.replace(/^<svg/,'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),a='<?xml version="1.0" standalone="no"?>\r\n'+a;var i="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a),r=document.createElement("a");r.setAttribute("download","feature-viewer.svg"),r.href=i,document.body.appendChild(r),r.click(),r.remove()}})},802:t=>{t.exports={dropdownOptions:{A:"Ala",R:"Arg",N:"Asn",D:"Asp",C:"Cys",E:"Glu",Q:"Gln",G:"Gly",H:"His",I:"Ile",L:"Leu",K:"Lys",M:"Met",F:"Phe",P:"Pro",S:"Ser",T:"Thr",W:"Trp",Y:"Tyr",V:"Val"}}},290:t=>{t.exports={crossIcon:'    <svg\nxmlns="http://www.w3.org/2000/svg"\nwidth="512"\nheight="512"\nfill="none"\nviewBox="0 0 512 512"\n>\n<path fill="#7D7D7D" d="M94 101H405V382H94z"></path>\n<path\n  fill="#DFDFDF"\n  d="M256 0C114.61 0 0 114.61 0 256s114.61 256 256 256c141.38 0 256-114.61 256-256S397.39 0 256 0zm87.72 307c13.06 12.28 17.61 26.86 4.11 40.55-13.5 13.69-28 9.52-40.57-3.41l-52.08-53.6c-18.33 19.5-34.31 36.71-50.52 53.69-12.47 13.07-27.19 16.91-40.53 3.18s-8.6-28.24 4.38-40.55c16.54-15.7 33.06-31.41 56.4-53.59-20.08-17-38.19-31.84-55.64-47.38-14-12.48-19.23-27.9-4.12-42.21 14-13.22 28.46-7.8 40.57 5.12 15.57 16.61 31.06 33.28 50.39 54 20-21.34 35.94-38.68 52.21-55.74 11.81-12.39 26-15.48 38.77-3.31 13.88 13.24 10.45 27.93-2.62 40.51-16.95 16.31-34.17 32.32-55.13 52.1 20.1 18.64 37.31 34.56 54.38 50.64z"\n></path>\n</svg>',deleteIcon:'<svg\nclass="delete-icon"\nxmlns="http://www.w3.org/2000/svg"\nx="0"\ny="0"\nviewBox="0 0 7 10.583"\n>\n<g color="#000" fontFamily="sans-serif">\n  <path\n    style={{\n      lineHeight: "normal",\n      fontVariantLigatures: "normal",\n      fontVariantPosition: "normal",\n      fontVariantCaps: "normal",\n      fontVariantNumeric: "normal",\n      fontVariantAlternates: "normal",\n      fontVariantEastAsian: "normal",\n      fontFeatureSettings: "normal",\n      fontVariationSettings: "normal",\n      WebkitTextIndent: "0",\n      textIndent: "0",\n      WebkitTextAlign: "start",\n      textAlign: "start",\n      WebkitTextDecorationLine: "none",\n      textDecorationLine: "none",\n      WebkitTextDecorationStyle: "solid",\n      textDecorationStyle: "solid",\n      WebkitTextDecorationColor: "#000000",\n      textDecorationColor: "#000000",\n      WebkitTextTransform: "none",\n      textTransform: "none",\n      WebkitTextOrientation: "mixed",\n      textOrientation: "mixed",\n      whiteSpace: "normal",\n      shapePadding: "0",\n      shapeMargin: "0",\n      inlineSize: "0",\n      isolation: "auto",\n      mixBlendMode: "normal",\n      solidColor: "#000000",\n      solidOpacity: "1",\n    }}\n    d="M3.506-52.386a.796.796 0 00-.793.792v.264H.799a.265.265 0 100 .529h.474l.315 4.672c.042.619.525 1.15 1.168 1.15H5.71c.643 0 1.125-.531 1.168-1.15l.316-4.672h.473a.265.265 0 100-.53H5.754v-.263a.796.796 0 00-.793-.792zm0 .529H4.96c.151 0 .263.112.263.263v.264H3.24v-.264c0-.15.115-.263.266-.263zM1.8-50.801h4.865l-.313 4.635c-.026.38-.283.658-.641.658H2.756c-.358 0-.615-.279-.64-.658z"\n    enableBackground="accumulate"\n    overflow="visible"\n    transform="translate(0 52.916)"\n  ></path>\n  <path\n    style={{\n      lineHeight: "normal",\n      fontVariantLigatures: "normal",\n      fontVariantPosition: "normal",\n      fontVariantCaps: "normal",\n      fontVariantNumeric: "normal",\n      fontVariantAlternates: "normal",\n      fontVariantEastAsian: "normal",\n      fontFeatureSettings: "normal",\n      fontVariationSettings: "normal",\n      WebkitTextIndent: "0",\n      textIndent: "0",\n      WebkitTextAlign: "start",\n      textAlign: "start",\n      WebkitTextDecorationLine: "none",\n      textDecorationLine: "none",\n      WebkitTextDecorationStyle: "solid",\n      textDecorationStyle: "solid",\n      WebkitTextDecorationColor: "#000000",\n      textDecorationColor: "#000000",\n      WebkitTextTransform: "none",\n      textTransform: "none",\n      WebkitTextOrientation: "mixed",\n      textOrientation: "mixed",\n      whiteSpace: "normal",\n      shapePadding: "0",\n      shapeMargin: "0",\n      inlineSize: "0",\n      isolation: "auto",\n      mixBlendMode: "normal",\n      solidColor: "#000000",\n      solidOpacity: "1",\n    }}\n    d="M3.44-49.742a.265.265 0 00-.264.265v2.645a.265.265 0 00.263.266.265.265 0 00.266-.266v-2.645a.265.265 0 00-.266-.265zM5.027-49.742a.265.265 0 00-.265.265v2.645a.265.265 0 00.265.266.265.265 0 00.264-.266v-2.645a.265.265 0 00-.264-.265z"\n    enableBackground="accumulate"\n    overflow="visible"\n    transform="translate(0 52.916)"\n  ></path>\n</g><svg>',bottomArrowIcon:'<svg\nxmlns="http://www.w3.org/2000/svg"\nx="0"\ny="0"\nenableBackground="new 0 0 48 48"\nviewBox="0 0 48 60"\n>\n<path d="M47.8 7.1C47.4 6.4 46.7 6 46 6H2C1.3 6 .6 6.4.2 7.1s-.3 1.5.1 2.1l22 32c.4.5 1 .9 1.6.9s1.3-.3 1.6-.9l22-32c.6-.7.6-1.5.3-2.1z"></path>\n</svg>',errorIcon:'\n<svg class="toast-icon" viewBox="0 0 102 102" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <circle cx="51" cy="51" r="51" fill="#FEF2F2" />\n  <path d="M51.5 83C34.13 83 20 68.87 20 51.5C20 34.13 34.13 20 51.5 20C68.87 20 83 34.13 83 51.5C83 68.78 68.87 83 51.5 83ZM51.5 25.31C37.1 25.31 25.4 37.01 25.4 51.41C25.4 65.81 37.1 77.51 51.5 77.51C65.9 77.51 77.6 65.81 77.6 51.41C77.6 37.01 65.9 25.31 51.5 25.31Z" fill="#F64F4E" />\n  <path d="M51.4998 56.09C49.9698 56.09 48.7998 54.92 48.7998 53.39V39.62C48.7998 38.09 49.9698 36.92 51.4998 36.92C53.0298 36.92 54.1998 38.09 54.1998 39.62V53.39C54.1998 54.92 53.0298 56.09 51.4998 56.09Z" fill="#F64F4E" />\n  <path d="M51.4998 65.99C50.7798 65.99 50.0598 65.72 49.6098 65.18C49.0698 64.64 48.7998 64.01 48.7998 63.29C48.7998 63.11 48.7998 62.93 48.8898 62.75C48.8898 62.57 48.9798 62.39 49.0698 62.21C49.1598 62.03 49.2498 61.94 49.3398 61.76C49.4298 61.58 49.5198 61.49 49.6998 61.31C50.6898 60.32 52.4898 60.32 53.4798 61.31C53.5698 61.4 53.7498 61.58 53.8398 61.76C53.9298 61.94 54.0198 62.03 54.1098 62.21C54.1998 62.39 54.1998 62.57 54.2898 62.75C54.2898 62.93 54.3798 63.11 54.3798 63.29C54.3798 64.01 54.1098 64.73 53.5698 65.18C52.9398 65.72 52.2198 65.99 51.4998 65.99Z" fill="#F64F4E" />\n</svg>\n',successIcon:'\n<svg class="toast-icon" viewBox="0 0 102 102" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <circle cx="51" cy="51" r="51" fill="#E8F8F1" />\n  <path d="M51.5 21C45.4677 21 39.5708 22.7888 34.5551 26.1402C29.5394 29.4916 25.6302 34.255 23.3217 39.8281C21.0132 45.4013 20.4092 51.5338 21.5861 57.4502C22.7629 63.3667 25.6678 68.8012 29.9333 73.0667C34.1988 77.3322 39.6333 80.2371 45.5498 81.4139C51.4662 82.5908 57.5987 81.9868 63.1718 79.6783C68.745 77.3698 73.5084 73.4606 76.8598 68.4449C80.2112 63.4292 82 57.5323 82 51.5C81.9902 43.4139 78.7736 35.6618 73.0559 29.9441C67.3382 24.2264 59.5861 21.0098 51.5 21V21ZM67.177 42.838L46.864 63.1306C46.5735 63.4399 46.1862 63.6407 45.766 63.7C45.6386 63.7247 45.5094 63.7383 45.3797 63.7407C45.2697 63.7472 45.1594 63.7334 45.0543 63.7C44.6342 63.6407 44.2469 63.4399 43.9563 63.1306L35.823 55.0177C35.6345 54.8296 35.4849 54.6061 35.3829 54.3601C35.2808 54.1142 35.2283 53.8505 35.2283 53.5842C35.2283 53.3178 35.2808 53.0542 35.3829 52.8082C35.4849 52.5622 35.6345 52.3388 35.823 52.1507C36.2069 51.7697 36.7258 51.5559 37.2667 51.5559C37.8075 51.5559 38.3264 51.7697 38.7103 52.1507L45.4203 58.8607L64.2897 39.971C64.6736 39.5901 65.1925 39.3763 65.7333 39.3763C66.2742 39.3763 66.7931 39.5901 67.177 39.971C67.3655 40.1591 67.515 40.3825 67.6171 40.6285C67.7191 40.8745 67.7716 41.1382 67.7716 41.4045C67.7716 41.6708 67.7191 41.9345 67.6171 42.1805C67.515 42.4264 67.3655 42.6499 67.177 42.838V42.838Z" fill="#4BBF62" />\n</svg>\n'}}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,n),r.exports}n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a=n(228);FeatureViewer=a})();